<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Index : Buci On Rails</title>
    <link rel="stylesheet" href="/css/main.css" type="text/css" media="screen" title="no title" charset="utf-8" />
  </head>
  <body>
    <div id="top-bar">
      <ul>
        <li><a href="http://feeds.feedburner.com/bucionrails">RSS</a></li>
        <li><a href="http://bucionrails.com/archives">Archives</a></li>
        <li><a href="http://bucionrails.com/about">About</a></li>
        <li><a href="#post-1">Top ^</a></li>
      </ul>
    </div>
    <div id="content">
      <div id="header">
        <h1>
          <!-- <span id="title-buci">Buci</span>
          <span id="title-on">On</span>
          <span id="title-rails">Rails</span> -->
          So let me tell you this.
        </h1>
        <div id="recent-post-list">
          Recent posts:
          <ul>
            <li><a href="#post-1">Cucumber meets Selenium meets integrity</a></li>
            <li><a href="#post-2">Rubygems under the hood: hooking into require</a></li>
            <li><a href="#post-3">I15R 0.3.2 is out!</a></li>                        
          </ul>
        </div>
        <!-- <h3 id="motto">Balint Erdi's tech blog</h3> -->
      </div>
      <div id="main">
        <div id="left">
          

<div class="article">
  <h1>
    <a href="/2009/12/14/i15r-031-is-out-now-with-haml-matchers.html">i15r 0.3.1 is out - now with haml matchers!</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/12/14/i15r-031-is-out-now-with-haml-matchers.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I&#8217;ve just released a new version of the <a href='http://github.com/balinterdi/i15r'>i15r gem</a> which alleviates the tedious task of internationalizing a Rails site by finding the &#8220;static&#8221; texts and replacing them with I18n message strings.</p>

<p>The good news -and probably the reason I am writing a blog post about it- is that it can now process <a href='http://haml-lang.com/'>haml</a> files, too. This must cheer up those who -like me- have come to like haml so much they now use it for their projects. So <a href='http://gemcutter.org/gems/i15r'>go get it</a> and let me know how it works for you.</p>
    <a href="/2009/12/14/i15r-031-is-out-now-with-haml-matchers.html" title="i15r 0.3.1 is out - now with haml matchers!">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/10/28/rubygems-under-the-hood-hooking-into-require.html">Rubygems under the hood: hooking into require</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/10/28/rubygems-under-the-hood-hooking-into-require.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>(See <a href='http://bucionrails.com/2009/10/20/rubygems-under-the-hood-introduction/'>the introduction</a> to the series.)</p>

<p>When you want to pull in a Ruby library, you require it. The library you require has to be on Ruby&#8217;s load path ($LOAD_PATH) in order to succeed. So let&#8217;s see how Rubygems hooks into this process.</p>

<p>The secret lies in custom_require.rb. You&#8217;ll see a nice comment near the top.</p>
<blockquote>
When you call "require 'x'", this is what happens:
  * If the file can be loaded from the existing Ruby loadpath, it is.
  * Otherwise, installed gems are searched for a file that matches.
If it's found in gem 'y', that gem is activated (added to the loadpath).
</blockquote>
<p>In fact, that explanation looks so straightforward to me that I doubt if I can add more words to precise it, so let&#8217;s look at the code together:</p>
<pre lang='ruby'>

module Kernel
  alias gem_original_require require
  (...)
  def require(path) # :doc:
    gem_original_require path
  rescue LoadError => load_error
    if load_error.message =~ /#{Regexp.escape path}\z/ and
       spec = Gem.searcher.find(path) then
      Gem.activate(spec.name, "= #{spec.version}")
      gem_original_require path
    else
      raise load_error
    end
  end
(...)
end
</pre>
<p>Aliasing a method, redefining it and calling the original version from the redefined method is a very familiar pattern if you have read Rails source code (called method chaining).</p>

<p>So, just as the above description says, if the file can be loaded &#8220;without Rubygems&#8221; it is and Rubygems never comes into the picture. If not, we make sure that the load error comes from the file not found on the load path and then find the gemspec for that file and activate it.</p>

<p>Activating it adds it to the load path, so we can call the original require safe in the knowledge that it will now succeed and we won&#8217;t get another load error this time around (and go into an infinite loop). Clever, heh?</p>

<p>This is one of the cases when the code is so simple for a moment I think I could have written it myself. With its </p>
    <a href="/2009/10/28/rubygems-under-the-hood-hooking-into-require.html" title="Rubygems under the hood: hooking into require">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/10/20/rubygems-under-the-hood-introduction.html">RubyGems under the hood: Introduction</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/10/20/rubygems-under-the-hood-introduction.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I am not sure about you, but one thing I keep bumping into while developing ruby applications is rubygem version conflicts. If you have ever come across &#8220;can&#8217;t activate activesupport (= 2.3.4, runtime) for <span />, already activated activesupport-2.3.3 for <span />&#8221; type of errors, you might be sympathetic to the cause.</p>

<p>Since <a href='http://rubygems.org/'>rubygems</a> was and is being written by some <a href='http://chadfowler.com'>excellent</a> <a href='http://richkilmer.blogs.com/'>Ruby</a> <a href='http://onestepback.org/'>minds</a> I knew the fault probably lies with me and not with the tool. Being a <a href='http://manifesto.softwarecraftsmanship.org/'>motivated and proud craftsman</a> I felt like I needed to know my tools and rubygems is probably the number one tool most of us Ruby developers use on a daily basis.</p>

<p>I intend to write a mini-series of Rubygems posts. A post will be added to the series when I explore some murky corner of rubygems inner mechanics. Some of the time this will come from a particular problem I come across while coding while on other occasions I might just look into the source code and try to understand what a particular piece of code does.</p>

<p>Now, I realized that when I read on a blog: &#8220;I will go into more detail about X in a forthcoming post&#8221;, it is the surest sign that you will never read about X again. At least not on that very blog. And I am not saying this in a mean way, I think it is very natural for our plans to change (&#8220;evolve&#8221; may sound better) even on the short term. So I am aiming low and hoping to give you more than you expected. (Notice I wrote &#8220;mini-series&#8221; which may just mean a couple of posts.) <h2>Do not set your expectations high</h2> I am absolutely not a Rubygems expert so please do not be fooled by the &#8220;under the hood&#8221; title. This will not be commensurate to <a href='http://weblog.jamisbuck.org/2006/10/2/under-the-hood-rails-routing-dsl'>Jamis Buck's series on Rails routing</a>. I do not -yet?- have a deep insight and I am not even a contributor to Rubygems.</p>

<p>The forthcoming :) series is just a humble attempt to gain an understanding of a very important part of the Ruby arsenal. I hope to understand it better by explaining to you how it works and I hope you will understand it better by reading my explanation. And last, but not least, I hope we&#8217;ll both spend less time debugging those tricky issues.</p>

<p>Having said that, I encourage you to participate in the series. Tell me about a particular problem you had with Rubygems. Correct me if I am wrong. Point me to an article where all this is already explained, and much better. Give feedback so this might evolve to be a discussion rather than an academic lecture. Thank you.</p>
    <a href="/2009/10/20/rubygems-under-the-hood-introduction.html" title="RubyGems under the hood: Introduction">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/09/25/cucumber-meets-selenium-meets-integrity.html">Cucumber meets Selenium meets Integrity</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/09/25/cucumber-meets-selenium-meets-integrity.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <a href='http://martinfowler.com/articles/continuousIntegration.html'>Continuous integration</a>
<p>Now I noticed that if a CI server is not in the mix right from the beginning of project, chances are it will never be, that was one of the first things I installed on a new Rails project. My server of choice is <a href='http://integrityapp.com'>Integrity</a> mostly because it is so easy to set up and quite straightforward to use.</p>

<p>Ok, so next we need some tests that Integrity will run at each commit and make sure the app can still be built. As a high-level acceptance test framework, I use <a href='http://cukes.info'>Cucumber</a>, which plays very nicely with <a href='http://seleniumhq.org/'>Selenium </a>for automated in-browser testing. Since nowadays even the most basic web application will have some amount of client-side scripting code (that is, javascript) if you really want to test the features of your application you&#8217;ll need Selenium tests.</p>

<p>That&#8217;s when matters get a bit more complicated when it comes to integrating these with the Integrity server. Why? Because on the server you usually don&#8217;t have the &#8220;desktop environment&#8221; which is available on the machine you do the development on. By default, you don&#8217;t run a desktop manager and have a graphic display on a server. A tool called <a href='http://linux.about.com/cs/linux101/g/xvfb.htm'>xvfb</a> comes into a picture that emulate a dumb framebuffer so you can still programs that need a graphic display.</p>

<p>To have some practical guidance, here&#8217;s what I did on an Ubuntu server to enable all of the above:</p>

<p>Install java since Selenium runs in the JVM: <pre lang='bash'>apt-get install java-common sun-java6-jre</pre> Install firefox since that&#8217;s what Selenium runs by default and that&#8217;s a very good choice. <pre lang='bash'>apt-get install firefox</pre> Install X since that&#8217;s what the xvfb launches and Xvfb itself. <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;bash&quot;&gt;apt-get install xorg xserver-xorg</pre></p>

<p>apt-get install xvfb&lt;/pre&gt; Next I found a <a href='http://wiki.openqa.org/display/SRC/Selenium-RC+and+Continuous+Integration'>wiki</a> that describes how to launch the Xvfb correctly. Log into the server and do: <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;bash&quot;&gt;startx -- `which Xvfb` :1 -screen 0 1024x768x24 2&gt;&amp;1 &gt;/dev/null &amp;&lt;/pre&gt;</pre> So Xvfb will run on the DISPLAY :1. So far so good. But something was still not quite right. When integrity launched the test suite that included some Cucumber-Selenium tests I received an error message basically saying that no browser sessions could be started. And the solution to that, in fact, is where this post wants to get at.</p>

<p>After a decent amount of head-scratching and code mining I realized that the Selenium server starts the browser on the same display where the server itself (the jar file) runs. I have found the relevant code that assembles the command that starts the Selenium server in the selenium-client gem and figured it was not meant to be run in graphic hardware-less environment since I saw no options to define which display it should run on. So as an <a href='http://github.com/balinterdi/selenium-client/commit/37094df174b5c52cb68d041f7dc940e501b3e438'>easy hack I added the hardcoded "DISPLAY=:1" before it</a> and crossed my fingers.</p>

<p>Bingo, it worked and I had a green build again! What&#8217;s more surprising is that it still runs perfectly on my Macbook so it seems to run in (some) graphical environments, too. It seems a bit strange to me to have found so little information on this subject since Rails, Cucumber, Selenium and CI are all en vogue so it is possible that I missed something obvious and there is an easier way to do all this. I am very eager to hear how others set up their CI to run automated-browser features. Do you use another tool, not Selenium? Do you use a CI server with a monitor?</p>

<p>Anyway, I certainly hope my hackish solution will prove to be useful for some of you TDD-minded developers out there who run their CI on a simple &#60;name of your favorite provider here&#62; slice.</p>
<strong>UPDATE: </strong><pre lang='ruby'>env["DISPLAY"] = ":1"</pre>
<p>There is still something left, though. When integrity -or, to be precise, the selenium process that was launched from integrity- wants to access display :1, it will be denied. You need to explicitly enable local connections by putting &#8220;localhost&#8221; in a file: <pre lang='bash'> echo 'localhost' &gt;/etc/X99.cfg</pre> , and then using that file as the access records list when you launch the server: <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;bash&quot;&gt;
xinit -- `which Xvfb` :1 -screen 0 1024x768x24 -auth /etc/X99.cfg 2&gt;&amp;1 &gt;/dev/null &amp;
&lt;/pre&gt;</pre> (Note that I launch xinit and not startx as before. startx somehow adds another -auth option which messes things up)</p>

<p>There, that should do it. It works and there is no code where it does not belong.</p>
    <a href="/2009/09/25/cucumber-meets-selenium-meets-integrity.html" title="Cucumber meets Selenium meets Integrity">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/07/14/a-prime-example-of-not-eating-your-own-dog-food.html">A prime example of not eating your own dog food</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/07/14/a-prime-example-of-not-eating-your-own-dog-food.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I realized how 20th century (plus boring and error-prone) it is to write one&#8217;s invoices by hand. So I went looking for an invoicing application. My expectations were quite low: I wanted one which can be used from my MacBook, has some basic functions that cut down on typing (e.g a client &#8220;database&#8221;), has a decent design and UI, can make out invoices in different currencies and did not cost more than ~$100.</p>

<p>It seemed like I have found <a href='http://www.native.hu'>one</a>, which, though it had several minor bugs, seemed acceptable, so I purchased the Basic version. Everything went reasonably well until I had to make out my first invoice in euros. It turned out that the Basic version can only make invoices in Hungarian forints in spite of having a couple of other functionalities (e.g set the VAT rate to 0% automatically on invoices made out to EU companies) which made me think it could make it in euros, too.</p>

<p>Ok, so accounting hell got me again. I sighed and asked the <a href='http://www.awasoft.hu/'>company</a> how much it would cost to have this funcionality. I was informed I had to buy the upgrade to the Business version which costs ~$120 more, roughly the double of the original price I paid! That was too much to take, so I went looking for another invoicing application. After all, it should not be an insurmountable task to write such an app, I murmured to myself.</p>

<p>I did find a <a href='http://lessaccounting.com'>couple of</a> <a href='http://billingsapp.com'>very good</a> applications which even overdo what I want them to accomplish. However, the Hungarian homologue of the IRS basically shuts out any foreign competitors by regulating very heavily which conditions must be fulfilled by an invoicing application for a Hungarian company to be able to use it. Bummer.</p>

<p>&#8220;There is still a glimmer of hope.&#8221; - I thought. I checked the Hungarian scene still thinking it could not be that difficult to meet my expectations. Well, apparently I was wrong. The <a href='http://szamlazz.hu'>ones</a> <a href='http://cipo.hu'>I</a> <a href='https://symbion.eu/'>found</a> are either overcomplicated to use, look like home pages in the 80s or are way too expensive. Sometimes all of these. So I put off the challenge of finding an acceptable piece of software and got back of writing invoices manually.</p>

<p>Now you might wonder where <a href='http://en.wikipedia.org/wiki/Eating_one%27s_own_dog_food'>the dog food</a> is in the story. Well, today I received the invoice from the company of my purchase of the Basic version of the application. It was written manually on an invoice sheet :) That&#8217;s tantamount of Steve Jobs using a PC with Windows Vista.</p>
    <a href="/2009/07/14/a-prime-example-of-not-eating-your-own-dog-food.html" title="A prime example of not eating your own dog food">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/07/12/john-doe-is-dull-the-importance-of-choosing-good-user-names-in-tests.html">John Doe is dull: the importance of choosing good user names in tests</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/07/12/john-doe-is-dull-the-importance-of-choosing-good-user-names-in-tests.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>We, developers, have to come up with user names all the time. In this glorious, pioneer era of TDD, more than ever we have to not only enter them into text fields but write them in test files that are part of the code and thus are clearly visible and permanent.</p>

<p>So it is important to give good names, but what is a good name like? I am not thinking about the semantics of the name (whether it has accented letters, or if it has two or three parts, etc.) but look at them from a very personal point of view: whether it makes you, the programmer, satisfied with your choice of names or bored with repeating the same old names you used in other projects and even in those projects, you had copied them from somewhere.</p>

<p>So when writing your first test where a user is needed, stop for a moment and imagine a world which you like and which is amusing in the context of your application&#8217;s domain (like <a href='http://www.youtube.com/watch?v=F2kAnTZBnTg'>philosophers playing soccer</a>, Luddites attending a technology conference, etc.). Pick some names and let the feeling that you have created something instead of just using old, boring names fill you with contentment. Whenever you need an other name, take one from your world. If you need further data (e.g date of birth) about your test users you can even do a little bit of research.</p>

<p>Though investing energy in this may reduce the time you spend writing code, compared to all the hours you put into a project, it is negligible. Nurturing this &#8220;subculture&#8221; in your tests can be very entertaining so you have a good time developing and are less prone to boredom. I think it pays off. We, Ruby programmers all know how important it is to be happy while programming and the effect it has on our productivity.</p>

<p>And besides, do you know of anyone who is called John Doe?</p>
    <a href="/2009/07/12/john-doe-is-dull-the-importance-of-choosing-good-user-names-in-tests.html" title="John Doe is dull: the importance of choosing good user names in tests">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/07/10/the-hashtag-hrt-retweet-bot-gemified.html">The hashtag (HRT) retweet bot gemified</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/07/10/the-hashtag-hrt-retweet-bot-gemified.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>A very simple twitter bot that retweeted everything that was tagged by a certain tag was put together for Scotland on Rails &#8216;09. Then, <a href='http://www.jaimeiniesta.com/'>Jaime Iniesta</a> adapted it for Euruko &#8216;09. I then forked from his repository, made a few simplifications and minor improvements and DRY-d its configuration.</p>

<p>Maybe most importantly I then turned it into <a href='http://github.com/balinterdi/hashtag_retweet_bot'>a gem</a> so that configuration files (including the bot&#8217;s which has the credentials for the twitter account) do not have to be included in the repository.</p>

<p>I also set up <a href='http://twitter.com/budapestrb'>a twitter account for the budapest.rb</a> group where an instance of the HRT  bot will post any tweets that have been tagged with #budapestrb. So, my fellow budapest.rb programmers, if you have anything to say about the budapest.rb, just make sure you include the #budapestrb tag in your tweet and watch the HRT bot repeat it.</p>

<p>To launch your own hashtag retweet bot, just follow the instructions in <a href='http://github.com/balinterdi/hashtag_retweet_bot/tree/master'>the README</a>.</p>
    <a href="/2009/07/10/the-hashtag-hrt-retweet-bot-gemified.html" title="The hashtag (HRT) retweet bot gemified">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/07/03/pragmatic-thinking-and-learning-on-twitter.html">Pragmatic Thinking and Learning on Twitter</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/07/03/pragmatic-thinking-and-learning-on-twitter.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Some of you may be aware of my grandiose plans with my twitter mini-framework named <a href='http://bucionrails.com/2009/06/22/twuckoo/'>twuckoo</a>. For my part I am constantly thinking about -hopefully reasonable- ways that it could be used for the better of mankind :)</p>

<p>The other part of the story is my enthusiasm with Pragmatic Programmers books. I have recently started <a href='http://pragprog.com/titles/ahptl/pragmatic-thinking-and-learning'>Pragmatic Thinking and Learning</a> by Andy Hunt which is also a very good one and found the familiar &#8220;resuming card&#8221; at the end. This card sums up the wisdom of the book in short phrases just so that you can recall what you read quickly. It is a great idea and can be found in other PP books, too.</p>

<p>So I asked at a PP email address which seemed to be closest to copyright questions whether I have the right to do this. To my surprise, it was the author himself, <a href='http://blog.toolshed.com/'>Andy Hunt</a>, who answered me and kindly gave me permission for the book in question. (Once again, thank you, Andy!)</p>

<p>So there you have it, <a href='https://twitter.com/pragthinklearn'>a twitter account that will serve you an advice each day</a> just so that you can &#8220;refactor your wetware&#8221; (the subtitle of the book) and hopefully help you be a better craftsman.</p>

<p>And now, my little twuckoo, on to world domination!</p>
    <a href="/2009/07/03/pragmatic-thinking-and-learning-on-twitter.html" title="Pragmatic Thinking and Learning on Twitter">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/07/02/installing-ruby-on-a-linode-slice.html">installing ruby on a linode slice</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/07/02/installing-ruby-on-a-linode-slice.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>To be able to experiment freely and find a store for my <a href='http://bucionrails.com/2009/06/22/twuckoo/'>twuckoos</a> and other goodies I have recently purchased a Linode 360 slice and had Ubuntu 9.04 installed on it. Next thing was setting up ruby (ruby 1.8.6, to be precise).</p>

<p>When deciding about how to install ruby, in part I wanted to have flexibility but mostly I wanted to feel like I am a professional sysadmin for some hours so I balked at pre-built ruby packages and went with the roll-your-own approach. I&#8217;ll summarize below the process and some pitfalls I encountered so it might help someone. <h2>Some basic tools</h2> First, you will need wget (or curl) to download the sources you will need along the way, so: <pre lang='bash'>$ sudo apt-get install wget</pre> Also, before you stare dumbly at the screen (like I did) wondering why can&#8217;t the stupid machine run make when the Makefile is clearly there in the directory , don&#8217;t forget to install make: <pre lang='bash'>$ sudo apt-get install make</pre> <h2>Updating the package repos</h2> Plus, since we&#8217;ll be installing packages that are found in the &#8220;universe&#8221; namespace (or whatever it is called) you should uncomment the below two lines in /etc/apt/sources.list : <pre lang='bash'>deb http://us.archive.ubuntu.com/ubuntu/ jaunty universe
deb-src http://us.archive.ubuntu.com/ubuntu/ jaunty universe</pre> &#8230; and then update your package index: <pre lang='bash'>$ sudo apt-get update</pre> <h2>Installing some packages ruby needs</h2> Before we download and build ruby, however, it is recommendable to have the zlib and openssl libraries so ruby can already bind to them. This is one of the things that is a lot easier to see with hindsight, but here I am, blogging this to you: <pre lang='bash'>$ sudo apt-get install zlib1g zlib1g-dev zlibc
$ sudo apt-get install openssl</pre> It turns out from <a href='http://www.ruby-forum.com/topic/71774'>this thread</a>, that the zlib bindings are part of ruby since 1.8.6 so you will not need the libzlib-ruby package.</p>

<p>Now, on to ruby itself. <h2>Ruby &amp; Rubygems</h2> <pre lang='bash'>$ wget ftp://ftp.ruby-lang.org/pub/ruby/ruby-1.8.6-p369.tar.bz2
(untar and cd to new directory)
$ ./configure
configure: error: no acceptable C compiler found in $PATH</pre> Piece of cake: <pre lang='bash'>$ sudo apt-get install gcc
$ ./configure
configure: error: in `/home/balint/ruby-1.8.6-p369':
configure: error: C compiler cannot create executables
See `config.log' for more details.</pre> A bit harder, but I have quickly found the answer <a href='http://ubuntuforums.org/showthread.php?t=17033'>here</a>, and then did: <pre lang='bash'>$ sudo apt-get install libc6-dev g++
$ ./configure
$ make
$ sudo make install
$ ruby -e "p 'hello from linode slice'"
"hello from linode slice"</pre> Rolling!</p>

<p>However, we all know that a ruby installation without gems is a toothless tiger (lion?) so we&#8217;ll install rubygems last, first downloading the source, and then installing it: <pre lang='bash'>$ wget http://rubyforge.org/frs/download.php/57643/rubygems-1.3.4.tgz
(untar and cd to new directory)
$ sudo ruby setup.rb</pre> If you want to use gems stored on github (and you probably do) it is convenient to add the gem github repository to your gem sources: <pre lang='bash'>$ gem source -a http://gems.github.com
$ sudo gem install balinterdi-twuckoo</pre> Ok, that&#8217;s all. I hope you have found this useful.</p>
<hr />
<p>If you receive an error message similar to the following when trying to install a gem: <pre lang='bash'>/usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- zlib (LoadError)</pre> Then you need to install the appropriate lib package and recompile ruby. Go to the directory where you unpacked the ruby source to and do: <pre lang='bash'>$ make clean
$ make
$ sudo make install</pre></p>
    <a href="/2009/07/02/installing-ruby-on-a-linode-slice.html" title="installing ruby on a linode slice">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/06/22/twuckoo-my-twitter-mini-framework.html">twuckoo - my twitter mini framework</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/06/22/twuckoo-my-twitter-mini-framework.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I am reading Andy Hunt&#8217;s excellent Pragmatic Thinking and Learning book. There is a section about so called &#8220;oblique strategies&#8221;, short, mysterious phrases that exercise your mind and make you look at problems from another perspective (e.g &#8220;repetition is a form of change&#8221;).</p>

<p>The suggested intake was once a day and there was a free application that did just this for Apple computers. However, the application was so outdated that I could no longer run it on my laptop. So, I set out to write that application and after a bit of thinking decided to make a twitter account where I (&#8221;I&#8221; meaning a script that I wrote :) ) would post an oblique strategy each day and then just follow that account. This way, I can also spread the knowledge around.</p>

<p>Thus <a href='http://github.com/balinterdi/twuckoo/tree/master' title='Twuckoo'>Twuckoo</a> was born. Twuckoo is a simple program (relying on <a href='http://github.com/cjohansen/twibot/tree/master'>twibot</a> for communication with twitter) that lets you periodically post a message on a twitter account. It can fetch the messages from a file, from a database, from the web or whereever you want it to retrieve them from. Its very modular in nature so it delegates the task of getting the next message to twitter and storing the posts to the module. here is currently one generic module, the one that fetches them from a file, and one that fetches them from wikipedia&#8217;s main page. I strongly hope that it is very easy for you to write your own module for your own purpose. Twuckoo aims to follow the &#8220;provide-what&#8217;s-needed-and-then-just-get-out-of-the-way&#8221; principle. Go check out <a href='http://github.com/balinterdi/twuckoo/tree/master'>the README</a> for further details.</p>

<p>It&#8217;s quite easy to install and run. You can find an example for the file-fetcher module at <a href='http://twitter.com/daily_oblique'>http://twitter.com/daily_oblique</a> and <a href='http://twitter.com/wikipedia_tfa'>http://twitter.com/wikipedia_tfa</a> grabs &#8220;Today&#8217;s Featured Article&#8221; from wikipedia and posts the title and the link so you can grow a little wiser each day :)</p>

<p>Since it is modular it&#8217;s very extensible. I kept the API very simple so writing modules should be a piece of cake. Each module has to define the following methods: <ol>
	<li><strong>load_tweets</strong> Loads the messages that can be twittered.</li>
	<li><strong>next</strong> Gets the next message that will be posted.</li>
	<li><strong>store(tweet)</strong> Store the tweet after it had been posted.</li>
</ol> Once more, I encourage you to scan through <a href='https://github.com/balinterdi/twuckoo/'>the README</a>, devise your own module and let me know about it. Any feedback is very welcome!</p>

<p>Note: For my Hungarian-speaking readers, I gave a <a href='http://docs.google.com/Presentation?id=dccxt9fm_3g8nf5fm5'>lightning talk about twuckoo</a> at the latest budapest.rb meetup.</p>
    <a href="/2009/06/22/twuckoo-my-twitter-mini-framework.html" title="twuckoo - my twitter mini framework">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/05/18/acts_as_trivia-would-you-like-to-play.html">acts_as_trivia: would you like to play?</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/05/18/acts_as_trivia-would-you-like-to-play.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>We all love playing games, from poker to soccer, from hide'n seek to ... trivia! I am a great fan of this latter and also of Rails apps so it was kind of natural for me to come up with the idea of using all the data in your Rails app to serve as the basis of trivia questions.</p><p>The ingredients are few and basic. You have a class with an attribute that is comparable and makes sense to compare (the population of states is a good example, the zip code of addresses is a counter-example).</p><h3>Installation</h3><h4>Install the gem</h4><ol>
<li>Install the gem through Rails's config.gem</li>

<p>Put this: </p>
<pre code='bash'>
    config.gem "balinterdi-acts_as_trivia", :source => "http://gems.github.com", 
:lib => "acts_as_trivia"
</pre>
<br />

<p>in your environment.rb and then run <em>rake gems:install</em> or <em>rake gems:unpack</em>.</p>

<li>Install it system-wide with the gem command</li>
<pre code='bash'>
  gem install acts_as_trivia --source http://gems.github.com
</pre>
</ol><h4>Make your app act as a trivia</h4><br /><p>You just have to run the provided trivia from the root of your Rails application:</p><pre code='bash'>
  ./script/generate acts_as_trivia
</pre><h4>Create trivia questions easily from the command line</h4><br /><pre code='bash'>
    ./script.generate acts_as_trivia_record country population name</pre><pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;/pre&gt;</pre><p style='margin-top:20px'>This trivia question will be about the <i>population</i> of <i>countries</i> and the  <em>name</em> of each will be used by the provided helpers for the sake of displaying something unique of each country.</p><h4>Create the pages to answer and assess trivia</h4><br /><p>The acts_as_trivia gem only aims to provide a clean interface and the logic, so you will have to create the <em>new</em> controller action of the <em>TriviaAnswersController</em> and the corresponding view: </p><pre code='bash'>
  /users/:user_id/trivias/:trivia_id/trivia_answers/new
</pre><p style='margin-top:20px'>However, you can take a look at these files in the <a href='=http://gist.github.com/raw/107361/f31caad451f0cca699288700aa3d98291a259fd1/gistfile1.rb'>rails app generator</a> or just directly copy them.</p><h3>Get right in the game</h3><p>Instead of going through the above steps, you can use a rails app generator to set up a trivia app quickly: </p><pre code='bash'>
rails my_shiny_app -m 
http://gist.github.com/raw/107361/f31caad451f0cca699288700aa3d98291a259fd1/gistfile1.rb
</pre><p style='margin-top:20px'>Once you go through the setup steps of the app generator, you have everything you need to have a functioning trivia app, so you can go to: </p><pre code='bash'>
  /users/1/trivias/1/trivia_answers/new
</pre><p style='margin-top:20px'>And if you created model instances you can already answer your first trivia question. For a more technical (and more complete) description, please see <a href='http://github.com/balinterdi/acts_as_trivia/tree/master'>the README</a>. Also, since this is a beta version, please make sure to report any bugs you might come across.</p>
    <a href="/2009/05/18/acts_as_trivia-would-you-like-to-play.html" title="acts_as_trivia: would you like to play?">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/05/01/protecting-actions-of-owner-type-associations.html">protecting actions of owner-type associations</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/05/01/protecting-actions-of-owner-type-associations.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>The actions of a web application basically fall into three categories based on their access rights:
<ol>
	<li>Actions with anonymous access</li>
	<li>Actions the user has to be logged in to access. (authenticated actions)</li>
	<li>Actions the user needs a certain privilege for to access (authorized actions)</li>
</ol>
</p><p>At the implementation level, the first category is obvious, since the actions in this category do not have to be protected. So let's shift our attention to the second and third category and consider how access protection for these can be achieved in Rails applications.</p><p>Both of these are best done with <a href='http://api.rubyonrails.org/classes/ActionController/Filters/ClassMethods.html'>before filters</a> since they run before the control is passed to the action's code and provide a DRY way to protect several actions.</p><h3>Authenticated actions</h3><p>Access restriction is quite straightforward once you have a basic library that provides a method to see if a user is logged in (see <a href='http://github.com/technoweenie/restful-authentication/tree/master'>restful-authentication</a> for a full-scale solution):</p><br /><pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre code=&quot;ruby&quot;&gt;
class ProfilesController &lt; ApplicationController
  before_filter :login_required 
  (...)
  def login_required
    redirect_to login_path unless logged_in?
  end
end
&lt;/pre&gt;</pre><br /><h3>Authorized actions</h3><p>This can be more tricky since there is a great deal of possibilities of what privilege is needed to access a certain action (e.g only admins can see the full user list, only managers can edit the employees' records, etc.).</p><p>I realized there is one very prevalent type, though, the owner-type access. Only the owner of a blog can modify its data, only the user of a profile can edit its attributes, only the leader of a project can set its deadline, etc. The number of these is endless and I bet there are basically no sites where this does not come up.</p><p>Also, the pattern of this access restriction is pretty much the same in all cases. There is the resource to be protected, its owner and the user currently logged in. For access to be granted, the owner of the resource needs to match the current user. So why not extract the pattern to be reused?</p><h3>Only owner</h3><p>Hence the <a href='http://github.com/balinterdi/only_owner/tree/master'>only-owner plugin</a> (I know I suck at naming projects) was born. By default, it will create a before filter in the controller which checks if it is the owner that wants to access the resource. If it is, access is granted. Otherwise, the user is redirected to the login path. Convention over configuration makes a lot of sense so to get up and running you only need to do these two things:</p><p>Install the plugin: </p><pre code='bash'>
./script/plugin install git://github.com/balinterdi/only_owner.git
</pre><br /><p>"Tag" the controller to be protected:</p><pre code='ruby'>
  class ProfilesController > ApplicationController
    only_owner
    (...)
  end
</pre><br /><p>That assumes that the profile can reach its user through the user association and that there is a find_profile method in scope in the controller. If your association or the finder method is named otherwise, you can pass the appropriate parameters to define them (:owner and :finder, respectively). As a -sensible, I reckon- convention, all methods in the controller except the new, create, index and show ones will be protected by default. Once again, this can be overridden with the usual :only and :except parameters.</p><p>I encourage you to scan through the <a href='http://github.com/balinterdi/only_owner/tree/master'>README</a> for the options and especially, as always, to give me some feedback.</p>
    <a href="/2009/05/01/protecting-actions-of-owner-type-associations.html" title="protecting actions of owner-type associations">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/04/27/upstream-or-downstream.html">upstream or downstream?</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/04/27/upstream-or-downstream.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>With the proliferation of <a href='http://chneukirchen.org/blog/archive/2007/02/introducing-rack.html'>middleware applications</a> the mentions of upstream and downstream servers has intensified so I decided to get to the end of this and find out what exactly an upstream server is. I first looked up <a href='http://en.wikipedia.org/wiki/Upstream_server'>wikipedia</a>:</p>
<blockquote>
In <a href='http://en.wikipedia.org/wiki/Computer_networking' title='Computer networking'>computer networking</a>, <strong>upstream server</strong> refers to a <a href='http://en.wikipedia.org/wiki/Server_(computing)' title='Server (computing)'>server</a> that provides service to another server. In other words, upstream server is a server that is located higher in the <a href='http://en.wikipedia.org/wiki/Hierarchy' title='Hierarchy'>hierarchy</a> of servers.
</blockquote>
<p>Ok, so based on this simplistic definition, a sketch of a request&#8217;s route to the application server and the response back can be illustrated like this:</p>
<img src='http://bucionrails.com/wp-content/uploads/2009/04/request-stack.jpg' border='0' />
<p>In this drawing, the middleware is an upstream server to the underlying application since it provides a service to it (be it caching, url mapping, exception handling and <a href='http://github.com/rack/rack-contrib/tree/master'>plenty of others</a>).</p>

<p>So now with my definition established, I was looking for examples in the wild that support it. <a href='http://mwrc2009.confreaks.com/13-mar-2009-11-05-in-a-world-of-middleware-who-needs-monolithic-applications-jon-crosby.html'>Jon Crosby's excellent presentation</a> at the MountainWest Ruby Conference used upstream in this context as far as I remember. Check one.</p>

<p>Browsing the source code of <a href='http://github.com/rtomayko/rack-cache/tree/master'>rack-cache</a> -which, by the way, I strongly encourage you to do if you want to understand caching (better) or just like the look of clean Ruby code- I realized Ryan Tomayko&#8217;s definition of upstream coincides with the above one since he uses downstream in the code to refer to the component/application below the rack-cache component. Check two.</p>

<p>I recently set up an nginx web server as a front end server to a mongrel cluster that runs a Rails application. Ok, so in this case, the nginx server must be the upstream server since requests hit there first and then are passed to the mongrels. One must hear the sound of collapse of cards in my head when I saw the following <a href='http://wiki.nginx.org/NginxHttpUpstreamModule'>nginx directive</a>:</p>
<pre code='ruby'>
upstream production_mongrels {
  server 127.0.0.1:8000;
  server 127.0.0.1:8001;
  server 127.0.0.1:8002;
}
</pre>
<p>Hmm, what? Nginx is above the component it provides a load-balancing service to so by any -ok, by my- definition the directive should say &#8220;downstream&#8221; and not &#8220;upstream&#8221;.</p>

<p>I realize that the request arrow on the diagram moving from top to bottom is a matter of convention and that it probably correlates with the fact that most languages write from the top to the bottom. Nevertheless, as far as I know Nginx is made by a Russian guy and Russians write top to bottom, too, so he should still use &#8220;downstream&#8221; for the directive, now shouldn&#8217;t he? Or did he simply start to sketch up boxes and arrows from bottom to top for the sake of it when designing his web server?</p>

<p>Summing up, I think the above described convention is the common one but since it is not standardized there will always be people and software that uses it the other way around. I am not overly confident though, so please tell me about your definition or just point to examples which support or contradict mine.</p>
    <a href="/2009/04/27/upstream-or-downstream.html" title="upstream or downstream?">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/04/24/have-your-to_param-begin-with-the-records-id.html">have your to_param begin with the record's id</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/04/24/have-your-to_param-begin-with-the-records-id.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>If you overwrite the to_param method in your model class such that it does not begin with its id, you can be in for a nasty surprise. Let's say you have a User class and you want URLs to contain the user's login instead of its id.</p><pre code='ruby'>
  class User
    def to_param
      self.login
    end
    ...
  end
</pre><p>And let’s assume you have a user called "bob". One might think the following works:</p><pre code='ruby'>
  >> bob = User.find(3)
  => #&lt;User id: 3, login: "bob", ...&gt;
  >> User.find(bob.to_param)
  ActiveRecord::RecordNotFound: Couldn't find User with ID=bob
</pre><p>But it does not. That's a problem since URLs are created by calling the to_param method of the model instances composing the path and a standard, nice way of finding the model instance (user in our example) in a controller action is to fetch the id (now: user_id) from the controller. That will quickly lead to error messages of the above form.</p><p>The reason that it does not work is that ActiveRecord's find method will look for a numerical id at the beginning of the argument. It extracts this id and discards anything that comes after it. It then looks up that id in the database and returns the instantiated record. No numerical id results in an error message. The solution from here on is straightforward, have your to_param return a string where the id comes first: </p><pre code='ruby'>
  class User
    def to_param
      "#{self.id}-#{self.login}"
    end
    ...
  end
</pre><pre code='ruby'>
>> bob = User.find(3)
=> #&lt;User id: 3, login: "bob", ...&gt;
>> User.find(bob.to_param)
=> #&lt;User id: 3, login: "bob", …&gt;
</pre><p>As a splendid way to prove my point but a totally useless piece of information is that you can put any non-numeric value after the id, and find will still find the record:</p><pre code='ruby'>
>> User.find("3-be-aware-of-what-you-overwrite-to-param-with")
=> #&lt;User id: 3, login: "bob", …&gt;
</pre>
<p>So I hope you have found this useful, see you in the next episode :)</p>
    <a href="/2009/04/24/have-your-to_param-begin-with-the-records-id.html" title="have your to_param begin with the record's id">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/04/09/yes-and-no-in-yaml.html">yes and no in YAML</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/04/09/yes-and-no-in-yaml.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I recently needed to display &#8216;yes&#8217; and &#8216;no&#8217; &#8220;internationally&#8221; depending on whether the value of a certain attribute is true or false. So I came up with this simple helper method:</p>
<pre code='ruby'>
  def to_yes_no(expr)
    expr ? I18n.t('yes') : I18n.t('no')
  end
</pre>
<p>and the corresponding translations in the yaml file:</p>
<pre code='ruby'>
  yes: sí
  no: no
</pre>
<p>It was so obviously correct and yet it did not work. It kept displaying &#8220;true&#8221; or &#8220;false&#8221;. After about an hour spent scratching my head and juggling with yaml files <a href='http://en.wikipedia.org/wiki/YAML'>I finally realized that YAML recognizes the strings Yes and No (or their lowercase versions)</a> and handles them as true and false.</p>

<p>Strictly speaking, one should always put quotes around the strings in the locale yaml files to make sure they are recognized as strings, but it&#8217;s so much uglier that way. Anyhow, the solution was precisely that:</p>
<pre code='ruby'>
  "yes": "sí"
  "no": "no"
</pre>
<p>Now I wonder if this is a case where the grammar designers (or whatever we call YAML) want to be smarter than the programmer. In any case, they were this time :)</p>
    <a href="/2009/04/09/yes-and-no-in-yaml.html" title="yes and no in YAML">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/03/25/finding-missing-i18n-translations-with-missing_t.html">finding missing I18n translations with missing_t</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/03/25/finding-missing-i18n-translations-with-missing_t.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>A recurring problem in an internationalized Rails project is to see which translations are missing. You could go through all the pages looking for &#8220;translation missing: en, user, new&#8221; texts. That, however is very tedious and error prone. There may be some texts you don&#8217;t even see that are missing translation. (like a title of an image).</p>

<p>A better solution is to write a program that finds these. So that&#8217;s what I did. I gave it a very imaginative name: <a href='http://github.com/balinterdi/missing_t/tree/master'>missing_t</a>. It&#8217;s darn simple. You first have to install the gem:</p>
<pre lang='bash'>
gem install balinterdi-missing_t  
</pre>
<p>and then from the root of your Rails app you type:</p>
<pre lang='bash'>
missing_t
</pre>
<p>You will see all the I18n strings that do not have translations along with the file they were found in. If you want to restrict your search for a specific language, you provide its language code as the first parameter, like so:</p>
<pre lang='bash'>
missing_t fr
</pre>
<p>For a bit more detailed description, <a href='http://github.com/balinterdi/missing_t/tree/master'>see the README</a>.</p>

<p>Go ahead, give it a try, your app has the right to speak all those beautiful languages out there!</p>
    <a href="/2009/03/25/finding-missing-i18n-translations-with-missing_t.html" title="finding missing I18n translations with missing_t">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/03/17/thrifty-track-your-expenses-easily.html">Thrifty - track your expenses easily</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/03/17/thrifty-track-your-expenses-easily.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Thrifty is a simple application I have written (and am still writing) in Sinatra that tracks your expenses. You can quickly record each spending you make and assign tags to them so you can group your expenditures easily. You can then see how much you spend in different categories (by tags) possibly narrowed down to a given date interval.</p>

<p>Anyway, a web app is all about interaction so give it a try <a href='http://thrifty.heroku.com'>on the test site</a> or download it from <a href='http://github.com/balinterdi/thrifty'>its github repo</a> and run it locally. You&#8217;ll also find a somewhat detailed README there.</p>

<p>This is a very early release so I&#8217;d appreciate any kind of feedback, be it a bug report, a comment on bad UI or anything you might find worthwhile sharing.</p>
    <a href="/2009/03/17/thrifty-track-your-expenses-easily.html" title="Thrifty - track your expenses easily">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/03/12/plans-for-2009-contribute-more-to-open-source-projects.html">plans for 2009 - contribute (more) to open source projects</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/03/12/plans-for-2009-contribute-more-to-open-source-projects.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>At the start of 2009 my friend Jaime <a href='http://www.jaimeiniesta.com/2009/01/07/mi-resumen-del-2008'>resumed his previous year</a> and proposed me to do the same. It seemed a really good idea but somehow it still died down.</p>

<p>I know it&#8217;s March now but I reckon it&#8217;s still ok to do this until December :) I&#8217;ll attempt to write a mini-series of posts about not so much what I did in 2008 but rather what I would like to achieve in 2009.</p>

<p>When I started to work full-time with Ruby I also realized the vast possibilities and magnetism of open source projects. I could -and still can- spend hours browsing among different projects on github, peeping into their code, reading related articles, etc.</p>

<p>So when I set out for this journey one of my tasks naturally became to regularly contribute to a &#8220;serious&#8221; open source project. When I got acquainted with Merb I also got to know <a href='http://datamapper.org/doku.php'>DataMapper</a>, its default ORM. I admired its elegance and coherence and the more I knew of it the more I liked it. So when the maintainer position of a dm-more gem, <a href='#dm-constraints'>dm-constraints*</a> seemed to be up for grabs I took the opportunity.</p>

<p>That was in December and since then I sent in a few patches and merged changes implemented by others. (which I realized could sometimes be a lot more difficult than writing code :) ). I like to do this and have learned -and probably will learn- a lot so one of my plans for 2009 is to continue with dm-constraints and maybe find other open source projects I could contribute to on a regular basis.</p>

<p>So, if you happen to use DataMapper, which <a href='http://bucionrails.com/2009/02/12/why-i-love-datamapper/'>I strongly encourage you to do</a>, and find a bug related to foreign-key constraints, <a href='http://datamapper.lighthouseapp.com/projects/20609-datamapper'>file a ticket</a> and assign it directly to me (Balint Erdi). And/or start contributing!</p>
<h3>Notes</h3><p id='dm-constraints'>* Dm-more is the meta package that contains everything outside the core functions of DataMapper. Dm-constraints deals with foreign key constraints. If you are familiar with ActiveRecord, it is basically the options you specify with :dependent on an association.</p>
    <a href="/2009/03/12/plans-for-2009-contribute-more-to-open-source-projects.html" title="plans for 2009 - contribute (more) to open source projects">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/03/12/easily-quote-passage-with-mail-in-a-reply.html">easily quote passage with Mail in a reply</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/03/12/easily-quote-passage-with-mail-in-a-reply.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>That was too long to twitter, so here it goes.</p>

<p>If you use Mail (OS-X) when replying to a message you can select some text in the email you want to reply to and then hit reply. The new email will only include the text you selected so you don&#8217;t have to delete all the lines you don&#8217;t need. I hope someone finds this useful, I really do.</p>
    <a href="/2009/03/12/easily-quote-passage-with-mail-in-a-reply.html" title="easily quote passage with Mail in a reply">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/02/12/why-i-love-datamapper.html">Why I love Datamapper</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/02/12/why-i-love-datamapper.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I wanted to find the last user in alphabetic order of their names in a Merb project that uses <a href='http://datamapper.org'>Datamapper</a> (the default ORM in Merb). So I did <span />:</p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;bash&quot;&gt;
irb(main):020:0&gt; User.all(:order =&gt; [:name]).first.name
 ~ (0.032946) SELECT &lt;column_names&gt; FROM `users` ORDER BY `name` LIMIT 1
=&gt; &quot;Admin User&quot;
&lt;/pre&gt;</pre>
<p>Ok, so the default sorting order is ascending but I need the last one. There are two ways to do this. Write an SQL snippet and sneak in &#8220;DESC&#8221; somewhere or reverse the collection before taking the first element. Since I was not sure how to sneak in &#8220;DESC&#8221; plus I prefer writing Ruby to writing SQL hands down, I went with the second approach:</p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;bash&quot;&gt;
irb(main):021:0&gt; User.all(:order =&gt; [:name]).reverse.first.name
 ~ (1.033271) SELECT &lt;column_names&gt; FROM `users` ORDER BY `name` DESC LIMIT 1
=&gt; &quot;XX XX&quot;
&lt;/pre&gt;</pre>
<p>See what happened? Instead of reverting the collection (which is extra time even if it is done very fast) Datamapper sneaked in that DESC for me! Isn&#8217;t this just brilliant? Datamapper takes the burden to write SQL off of your shoulders. You can keep writing Ruby statements you presumably love and let Datamapper take care of the SQL reaping both the comfort and the performance gain. <span />. Also, likewise your app stays database type agnostic. Note how it is not supposed there is a RDBMS under the ORM layer. It could work with CouchDB, for example (I think there is actually work in progress for a CouchDB adapter). This is not the only reason I like Datamapper so much, so if you are still not convinced, go check out <a href='http://datamapper.org/doku.php?id=why_datamapper'>some other reasons to use it</a>.</p>
<hr /><h3>Notes</h3><pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;p id=&quot;love-datamapper-first&quot;&gt;* I could have written this one in a simpler way:
&lt;pre lang=&quot;bash&quot;&gt;
irb(main):018:0&gt; User.first(:order =&gt; [:name]).name
 ~ (0.032345) SELECT &lt;column_names&gt; FROM `users` ORDER BY `name` LIMIT 1
=&gt; &quot;Admin User&quot;
&lt;/pre&gt;</pre>
<p>But you -or at least I- could not do it for the last element (there is no User.last)</p>
<p id='love-datamapper-second'>** I am not suggesting not to learn SQL at all. I am all for a know-thy-tools approach (especially it it means not cluttering your markup with javascript :) ). However, having the ORM do obviously good things for you is worth it most of the time.
</p>
    <a href="/2009/02/12/why-i-love-datamapper.html" title="Why I love Datamapper">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/02/11/deep_test-to-become-tdd-more-easily.html">deep_test to become TDD more easily</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/02/11/deep_test-to-become-tdd-more-easily.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I am all for <acronym title='Test Driven Development'>TDD</acronym>, really. I did not even waver when recently I have been working on a medium-sized Rails project and running the tests after each change took about 60-80 seconds. 60 seconds is still a lot, though, especially if you go through these cycles ~50 times a day (a wild guess). I also believe in very short test-implementation cycles to stay focused so I was starting to think about ways to keep that time down.</p>

<p>Autotest, part of the <a href='http://rubyforge.org/projects/zentest/'>Zentest</a> toolbox is a very good choice. It basically runs all the tests automatically after something has changed in the code and more importantly it only runs the tests it deems affected by the latest change. This helped to reduce the amount of time by reducing the number of tests that were run in each loop.</p>

<p>Another I think less well-known option is <a href='http://www.somethingnimble.com/bliki/deep-test'>deep_test</a> which helps to reduce testing time by increasing computational power. More precisely, it runs the tests through worker threads so you can either benefit from using deep_test if you set it up for a computer network (individual computers take from a pool of tests and then send in the results) or if you have a multi-core computer. Since many of us do nowadays, that stepped up as a viable option.</p>

<p>It was quite easy to set up and the results it brought were quite remarkable. It reduced the running time of my tests by ~40% (based on a completely unscientific benchmark). One thing I experienced is that it did not really play out well with sqlite although I have not spent a lot of time trying to make it work there. I just switched to mysql and it worked seamlessly. So yeah, the next logical step was to get the better of both worlds: run only the tests that need to be run and run them on as many cores as possible. I will talk about that in a later post.</p>

<p>I would very much like to hear your experiences and solutions to make TDD a breeze or just plain bearable. I cannot imagine doing real TDD if running tests takes more than a certain time limit, around maybe 90 seconds. Not only you lose a lot of time waiting for the tests to finish, more importantly you fall out of the falling test-implementation cycle, you lose focus, your mind drifts away and then the whole thing probably just does not work.</p>
    <a href="/2009/02/11/deep_test-to-become-tdd-more-easily.html" title="deep_test to become TDD more easily">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/02/09/simple-to-do-list-in-sinatra.html">simple to-do list in Sinatra</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/02/09/simple-to-do-list-in-sinatra.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>After Bence Golda&#8217;s presentation at the last <a href='http://www.meetup.com/budapest-rb/'>budapest.rb meetup</a> I decided to build something easy in <a href='http://www.sinatrarb.com/'>Sinatra</a> since it seemed so cool and easy to do. And I have to tell you, it really is both.</p>

<p>With zero prior experience with Sinatra and only a bit of fresh <a href='http://haml.hamptoncatlin.com/'>HAML</a> knowledge, <a href='http://github.com/balinterdi/todo-list/tree/master'>my todolist</a> was ready in a few hours. What can you do with it? Add todos to your list and delete them when you are done. What features does it have? Unobtrusive javascript :) What does it lack? Obtrusive javascript :) User-related funcionalities, the possibility of having more lists, seeing done todos, etc. Lots of things. But with the ease of development Sinatra provides I am sure that for a simple application like this these could be added quite quickly. And then <a href='http://tadalist.com/'>tadalist.com</a> would be running for its money :) (I know, it&#8217;s free).</p>

<p>ps. I use an ORM, datamapper to not to have to deal with SQL directly, so you&#8217;ll have to &#8220;gem install dm-core&#8221; beyond the sinatra gems if you want to run the app.</p>
    <a href="/2009/02/09/simple-to-do-list-in-sinatra.html" title="simple to-do list in Sinatra">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/02/04/strings-as-haml-render-parameters-in-sinatra-do-not-work.html">strings as haml render parameters in Sinatra do not work</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/02/04/strings-as-haml-render-parameters-in-sinatra-do-not-work.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I was intrigued by the simplicity and elegance of Sinatra as presented by Bence Golda at <a href='http://files.meetup.com/1271139/09-01-22-golda_bence-sinatra.pdf'>the last budapest.rb meetup.</a>, so I decided to build a simple application with it (I am planning to talk just a little bit more about that in a later post).</p>

<p>One quick thing I learned the hard way is when generating haml views in Sinatra, you have to use symbols as the name of the view, strings will just be rendered as strings. That was a tough lesson to learn coming from Rails. So while in Rails you can write:</p>
<pre lang='ruby'>
  def index
    render :action => :index
  end
</pre>
<p>or</p>
<pre lang='ruby'>
  def index
    render :action => "index"
  end
</pre>
<p>In Sinatra, you can only use a symbol to designate the view to be rendered:</p>
<pre lang='ruby'>
get '/' do
  haml :index
end
</pre>
<p>Which makes sense, I think, since symbols (unlike strings, see <a href='#strings-symbols'>below</a>) with the same name refer to the same entity which is a perfect fit for naming views, now ain&#8217;t they? Plus, I&#8217;ll admit I am in love with them symbols, with their colon in the front and all. And when they are syntax highlighted, I melt.</p>
<div id='strings-symbols'>
<pre lang='bash'>
irb(main):002:0> sym1 = :index; sym2 = :index; sym1.object_id == sym2.object_id
=> true
irb(main):003:0> s1 = "index"; s2 = "index"; s1.object_id == s2.object_id
=> false
</pre>
</div>
    <a href="/2009/02/04/strings-as-haml-render-parameters-in-sinatra-do-not-work.html" title="strings as haml render parameters in Sinatra do not work">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/01/28/shoulda-blocks-active-record-macros-and-their-order.html">Shoulda: setup and should blocks and don't wander off the map</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/01/28/shoulda-blocks-active-record-macros-and-their-order.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I&#8217;m using <a href='http://www.thoughtbot.com/projects/shoulda/'>shoulda</a> for testing in a rails project and I wrote this simple test to see if my update action really updated the object and redirected to the appropriate place:</p>
<pre lang='ruby'>
context "the update" do
  setup do     # 1
    @project = Factory(:project, :director => @user)
    put :update, :id => @project, :project => { :name => "updated name" }
  end
  # 2    
  updated_project = Project.first(:order => "created_at DESC")
  # 3
  should_redirect_to "project_url(updated_project)" # 4
  should "update the attributes" do
    assert_equal("updated name", updated_project.name) # 5
  end  
end
</pre>
<p>To my surprise, I received an &#8220;undefined local variable or method &#8216;updated_project&#8217; on both tests (#4 and #5). I figured out why and I want to share it with you. In case you are a shoulda expert, you must know the answer already and sorry for wasting your time. On the other hand, if you are new to shoulda like I am, you may find this useful.</p>

<p>What shoulda does when running a &#8216;should&#8217; block is that it runs all the &#8216;setup&#8217; blocks of the contexts in which it is nested, from the outside to the inside, so this:</p>
<pre lang='ruby'>
context "alpha" do
  setup do
    puts "A"
  end
  context "beta" do
    setup do
      puts "B"
    end
    context "gamma" do
      setup do
        puts "C"
      end
      should "work" do
         puts "the only test"
      end
    end
  end
end
</pre>
<p>Will print <pre lang='bash'>
A
B
C
the only test
</pre></p>

<p>Also the area between #2 and #3 in the above test is sort of a no man&#8217;s land, since it is not in a setup block, so assignments that are executed here are completely useless. You can not use it either for side-effects since it will run before the setup block (#1 above). My advice is to simply put everything in a block, be it a &#8216;setup&#8217; or a &#8216;should&#8217; one. (the &#8216;should_redirect_to&#8217; is a macro that&#8217;s part of shoulda, it gets expanded into a block, too).</p>

<p>So here is the same test correctly:</p>
<pre lang='ruby'>
context "the update" do
  setup do
    @project = Factory(:project, :director => @user)
    put :update, :id => @project, :project => { :name => "updated name" }
  end
  
  should_redirect_to "project_url(@project)" 
  should "update the attributes" do
    # reload is needed to see the new state
    @project.reload
    assert_equal("updated name", @project.name)
  end
  
end
</pre>
<p>Shoulda is a nice tool. There is only one I know and I like a tad better which is quite similar in structure, <a href='http://rspec.info/documentation/'>rspec</a>.</p>
    <a href="/2009/01/28/shoulda-blocks-active-record-macros-and-their-order.html" title="Shoulda: setup and should blocks and don't wander off the map">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/01/25/mysql-table-types-and-foreign-key-constraints.html">MySQL table types and foreign key constraints</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/01/25/mysql-table-types-and-foreign-key-constraints.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Uff, I have recently spent some time checking foreign key constraints in MySQL and I got a bit upset. The MySQL docs tell you that <a href='http://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html'>InnoDB tables support foreign key constraints</a> but that&#8217;s not the same as saying MyISAM tables do not. More importantly, an error (or at least a warning) should be raised so that I am not relying on something that seems to be there when in fact it is not.</p>

<p>Here is the raw SQL:</p>
<pre lang='sql'>
CREATE TABLE `drivers` (
  `id` INT PRIMARY KEY AUTO_INCREMENT,
  `name` VARCHAR(100)
);


CREATE TABLE `cars` (
  `id` INT PRIMARY KEY AUTO_INCREMENT,
  `plate_number` VARCHAR(12),
  `driver_id` INT,
  FOREIGN KEY (`driver_id`) REFERENCES `drivers`(`id`) ON DELETE CASCADE
);

INSERT INTO drivers(name) VALUES ('bob');
INSERT INTO drivers(name) VALUES ('alice');
INSERT INTO cars(plate_number, driver_id) VALUES ('bbb', 1);
INSERT INTO cars(plate_number, driver_id) VALUES ('ooo', 1);
INSERT INTO cars(plate_number, driver_id) VALUES ('aaa', 2);
INSERT INTO cars(plate_number, driver_id) VALUES ('lll', 2);
</pre><pre lang='shell'>
mysql> delete from drivers where id=1;
Query OK, 1 row affected (0.00 sec)

mysql> select * from cars;
+----+--------------+-----------+
| id | plate_number | driver_id |
+----+--------------+-----------+
|  1 | bbb          |         1 | 
|  2 | ooo          |         1 | 
|  3 | aaa          |         2 | 
|  4 | lll          |         2 | 
+----+--------------+-----------+
4 rows in set (0.00 sec)
</pre><pre lang='sql'>
CREATE TABLE `drivers` (
  `id` INT PRIMARY KEY AUTO_INCREMENT,
  `name` VARCHAR(100)
) ENGINE=INNODB;


CREATE TABLE `cars` (
  `id` INT PRIMARY KEY AUTO_INCREMENT,
  `plate_number` VARCHAR(12),
  `driver_id` INT,
  FOREIGN KEY (`driver_id`) REFERENCES `drivers`(`id`) ON DELETE CASCADE
) ENGINE=INNODB;

INSERT INTO drivers(name) VALUES ('bob');
INSERT INTO drivers(name) VALUES ('alice');
INSERT INTO cars(plate_number, driver_id) VALUES ('bbb', 1);
INSERT INTO cars(plate_number, driver_id) VALUES ('ooo', 1);
INSERT INTO cars(plate_number, driver_id) VALUES ('aaa', 2);
INSERT INTO cars(plate_number, driver_id) VALUES ('lll', 2);
</pre><pre lang='shell'>
mysql> delete from drivers where id=1;
Query OK, 1 row affected (0.00 sec)

mysql> select * from cars;
+----+--------------+-----------+
| id | plate_number | driver_id |
+----+--------------+-----------+
|  3 | ppp          |         2 | 
|  4 | eee          |         2 | 
+----+--------------+-----------+
2 rows in set (0.00 sec)
</pre>
<p>I know very well one should <a href='http://bucionrails.com/2008/10/22/postgresql-pg_hbaconf-authentication/'>read the manual before complaining</a> but I also think software should complain if asked something which it is not capable of doing. -1 for MySQL.</p>
    <a href="/2009/01/25/mysql-table-types-and-foreign-key-constraints.html" title="MySQL table types and foreign key constraints">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/01/17/google-groups-tracker-using-yahoo-pipes.html">Google Groups tracker using Yahoo Pipes</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/01/17/google-groups-tracker-using-yahoo-pipes.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I -and I suppose most of my developer mates- am subscribed to many Google Groups. When there is a topic I am interested in or a problem I posted or replied to it would be cool to get notified of changes to it. Instead of checking it five times a day to see if someone has commented on it which also slices up the big, continuous chunks of time we programmers need. Also, some groups are littered by spam topics so it would be nice to filter out all the things you are not particularly fascinated about and be left with the things you are.</p>

<p>Unfortunately, Google Groups does not offer us the possibility of following certain topics (e.g by sending you an email whenever someone added his comment, a la Lighthouse). But there is a solution although I&#8217;ll admit the one I am describing below is not a particularly cunning or elegant one. If you felt the same pain and found a remedy, I am curious to know what it is, so please leave a comment.</p>

<p>So, as we all know, the Internet is just a <a href='http://en.wikipedia.org/wiki/Series_of_tubes'>series of tubes</a>, so the idea to use Yahoo Pipes to cobble together something came quite naturally. Ladies and gentlement, I created the <a href='http://pipes.yahoo.com/balinterdi/google_groups_issue_tracker'>Googe Groups issue tracker</a>. It is capable of tracking two Google groups. You can pass three strings for each one and it generates an RSS of the items whose title have any of the strings you provide.</p>

<p>I know it has many shortcomings (to say the least). What if you want to track issues for 3 groups or more? More than 3 issues per group? My puny tracker can&#8217;t do that right now since its &#8220;legoed&#8221; together from <a href='http://pipes.yahoo.com/pipes/'>Yahoo Pipes</a> building blocks and so it&#8217;s not programmable. You can, however, clone my pipe, expand it to handle more groups or more expressions, enter the groups you want to track and subscribe to the resulting RSS with your reader of choice.</p>

<p>It may still feel clumsy, since you have to regularly update your strings based on the issues you are interested in. I know a more general solution would be to hack together something that is more manageable and expandable which I might do soon. But it still feels so good from time to time to leave the serious, hard-thinking adult world and build Lego castles. So go ahead, don&#8217;t be shy, build your own castle and let me know about it! :)</p>
<strong>UPDATE:</strong>
<p>Let&#8217;s suppose you are a <a href='http://datamapper.org'>DataMapper</a> expert and you want to help those newbies/impatient people who put &#8216;help&#8217; in the title of their post. In that case, you would input http://groups.google.com/group/datamapper in the &#8220;Group1 URL&#8221; box and &#8220;help&#8221; in the &#8220;Group1 - Title 1&#8221; field. At the pipe output you&#8217;d only see those posts which have help in their title, then.</p>

<p>If you want to also see announcements and the convention would be to have <span>DM</span> in the title of those posts, you would then enter &#8221;<span>DM</span>&#8221; in the &#8220;Group1 - Title 2&#8221; field.</p>

<p>To construct a filter which only lists ruby-quiz related posts on <a href='http://groups.google.com/group/ruby-talk-google'>http://groups.google.com/group/ruby-talk-google</a> is left as an exercise to the reader :).</p>
    <a href="/2009/01/17/google-groups-tracker-using-yahoo-pipes.html" title="Google Groups tracker using Yahoo Pipes">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/01/17/a-ruby-style-currency-converter.html">A ruby-style currency converter</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/01/17/a-ruby-style-currency-converter.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Though it is said that we live in a highly-globalized world, all countries still have their own proper currency (with one exception that I know of, the euro) so we still need to convert between them. If one is used to shop online (and one is) the need to get the price in the <a href='http://en.wikipedia.org/wiki/Hungarian_forint' target='_blank'>national currency</a> occurs quite often. Going to a currency converter page is not much of a hassle but it still takes too much time and it seemed an overshoot to use a browser for this task. Inspired by Rails&#8217;s date calculations extensions (where you could write 3.days.ago), I decided to create something similar and see how much flying to <a href='http://euruko2009.org/'>Barcelona</a> or buying a <a href='http://pragprog.com/'>PragProg</a> book costs from the command line.</p>
<pre lang='ruby'>

require "net/http"
require "open-uri"
require "hpricot"

# makes 1284.eur.to.usd types of queries possible
class CurrencyConverter
 
  Currencies = { :huf => "HUF", :eur => "EUR", :usd => "USD", :gbp => "GBP", :chf => "CHF" }
 
  # these methods "close" the quote.
  # when they are called, it means all data is ready
  # the quote can be sent.
  class_eval do
    Currencies.each_key do |curr|
      define_method curr do
        @to = curr
        calculate
      end
    end
  end
 
  def initialize(amount, from=nil, to=nil)
    @amount = amount
    @from = from
    @to = to
  end
 
  def send_request_for_quote
   from_as_param = @from.to_s.upcase
   to_as_param = @to.to_s.upcase
   url = "http://xurrency.com/#{[@amount, @from, @to].join('/')}/feed"
   doc = Hpricot(open(url).read)
   (doc/'dc:value').inner_html
  end
 
  def calculate
    send_request_for_quote
  end

  def to
    self
  end
 
end

class Fixnum 
  def method_missing(name)
    CurrencyConverter.new(self, name)   
  end
end
</pre>
<p>Thanks to ruby&#8217;s open classes, the code is quite terse (you can also see and download the raw script from <a href='http://www.pastie.org/362737'>here</a>). Now you can fire up irb and do all the conversions you want:</p>
<pre lang='shell'>
$ irb -r currency_converter.rb 
irb(main):001:0> 23.eur.to.huf
=> "6473.3500"
irb(main):002:0> 1.usd.to.eur
=> "0.7642"
</pre>
<p>Or do it through the ruby interpreter:</p>
<pre lang='shell'>
$ ruby -r rubygems -r currency_converter.rb -e "puts 1.eur.to.usd"
1.3085
</pre>
<p>I find it very pleasing to be able to write &#8220;10.eur.to.usd&#8221; since it is so close to our spoken, human language. One of ruby&#8217;s numerous charms.</p>

<p>My friend, <a href='http://www.rubyrailways.com/'>Peter</a> sent a more general solution that uses html scraping with <a href='http://scrubyt.org/'>Scrubyt</a> and the conversion capabilities of Google search:</p>
<pre lang='ruby'>
require 'rubygems'
require 'cgi'
require 'scrubyt'

begin
google_converter = Scrubyt::Extractor.define do
  fetch "http://www.google.com/search?q=#{CGI::escape(ARGV[0])}+#{CGI::escape(ARGV[1])}+to+#{CGI::escape(ARGV[2])}"
  
  google_result "//td[@dir='ltr']" do
    final_result(/= (.+) /)
  end
end
  puts google_converter.to_hash[0][:final_result]
rescue
  puts "Sorry, even *google* can't translate that!"
end
</pre>
<p>Using this you can convert amounts between any two currencies (distances, weights, etc., everything that Google search can handle):</p>
<pre lang='shell'>
$ ruby conv.rb 30 EUR HUF
</pre>
<p>It may be swimming against the current but I like solutions that do not need the browser for simple problems like this one. I scratched my itch and hopefully scratched yours, too.</p>
    <a href="/2009/01/17/a-ruby-style-currency-converter.html" title="A ruby-style currency converter">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2009/01/05/record-your-bike-trips-with-gmap-pedometer.html">Record your bike trips with Gmap Pedometer</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2009/01/05/record-your-bike-trips-with-gmap-pedometer.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Though I thought I would only post about technical issues here, I now make an exception. After all, (soft) rules are for breaking occasionally, aren&#8217;t they?</p>

<p>So in case you don&#8217;t know, there is a nice <a href='http://www.gmap-pedometer.com/' title='Gmap Pedometer' target='_blank'>service out there to record your bike trips</a> that I have recently discovered. It is a Google Maps application where you first search your point of departure then your point of arrival and Gmap Pedometer does the rest for you. Occasionally you have to lend it a helping hand, though, in case the automatic route generation does not work well. It usually does not if you take bicycle roads that does not run paralelly with the highway since the automatic route generation selects the &#8220;car route&#8221; by default (it seemed to me). You can set up your itinerary in no time and promptly see the distance you did and how much energy you burned during the process (and ultimately also the elevation of your trip).</p>

<p>I also grab the opportunity to tell you how bike tours are the perfect way of tourism for me. You can easily do 40-50kms per day in a moderate pace. In my opinion that&#8217;s a perfect middle ground between being too slow and passing by magnificent landscapes and towns in a car. What&#8217;s more, there is the thrill of riding your bike, feeling the air against your cheeks, the ability to stop anywhere and the ambiance of adventure that comes with the nomad lifestyle.</p>

<p>One thing I miss is a convenient method to store your trips. According to the site itself, Gmap Pedometer is &#8220;A hack that uses Google&#8217;s mapping application to help record distances traveled and calories burned during a running or walking workout.&#8221; so one should not expect a full-fletched, shiny application but a basic user registration/login method would be handy so I could quickly access my trips. To be able to review your trips, you must store the unique url that is generated for each one in a safe place.</p>

<p>To give you some example routes and also to store a pointer to some trips I would like to be able to access in the future I list the daily routes of two fairly recent bike routes:</p>

<p>The Netherlands (summer 2007)</p>
<a href='http://www.gmap-pedometer.com/?r=2438133' target='_blank'>Amsterdam - Den Haag</a><a href='http://www.gmap-pedometer.com/?r=2438137' target='_blank'>Amsterdam - Enkhuizen</a><a href='http://www.gmap-pedometer.com/?r=2438142' target='_blank'>Urk - Elburg</a><a href='http://www.gmap-pedometer.com/?r=2438147' target='_blank'>Elburg - Appeldoorn (Beekbergen)</a><a href='http://www.gmap-pedometer.com/?r=2438149' target='_blank'>Beekbergen - Arnhem (Oosterbeek)</a>
<p>Austria, going along the Danube (summer 2006)</p>
<a href='http://www.gmap-pedometer.com/?r=2438164' target='_blank'>Passau - Obernzell</a><a href='http://www.gmap-pedometer.com/?r=2438172' target='_blank'>Obernzell - Feldkirchen</a><a href='http://www.gmap-pedometer.com/?r=2438183' target='_blank'>Feldkirchen - Au an der Donau</a><a href='http://www.gmap-pedometer.com/?r=2438189' target='_blank'>Au an der Donau - Willersbach</a><a href='http://www.gmap-pedometer.com/?r=2438194' target='_blank'>Willersbach - Aggsbach</a><a href='http://www.gmap-pedometer.com/?r=2438196' target='_blank'>Aggsbach - Krems</a>
<p>So what are you waiting for? Hop on your bike! :)</p>

<p>ps. Walking trips can also be recorded on the site and there is automatic route generation for walkers, too.</p>
    <a href="/2009/01/05/record-your-bike-trips-with-gmap-pedometer.html" title="Record your bike trips with Gmap Pedometer">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/12/15/ruby-metaprogramming-call-counter-take-2.html">Ruby metaprogramming: Call counter - Take 2</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/12/15/ruby-metaprogramming-call-counter-take-2.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>So <a href='http://bucionrails.com/2008/12/06/exploring-ruby-metaprogramming-call-counter/' target='_blank'>last time</a> I left you with the promise that I&#8217;d return with a solution so that the number of times a certain method was called is a class method which makes more sense than if it was an instance method. So here is the &#8220;improved version&#8221;:</p>
<strong>call_counter.rb:</strong><pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;ruby&quot;&gt;

module CallCounter
		
    def count_calls_to(method_name)
      original_method = instance_method(method_name)
    		
      unless class_variable_defined?(:@@call_counter):
        class_variable_set(:@@call_counter, {})
      end
    
      call_counter = class_variable_get(:@@call_counter)
    
      define_method(method_name) do |*args|
        call_counter[method_name] ||= 0
        call_counter[method_name] += 1
        bound_original_method = original_method.bind(self)
        bound_original_method.call(*args)
      end

      metaclass = class &lt;&lt; self; self; end
      metaclass.instance_eval do

        define_method(:calls_to) do |m|
          call_counter[m].nil? ? 0 : call_counter[m]
        end

        define_method(:reset_counters) do
          call_counter.each_key do |k|
            call_counter[k] = 0
          end
        end
    end
    
  end

end
&lt;/pre&gt;</pre>
<p>What has changed is the introduction of a class variable that counts the calls on all watched methods and that the number of calls on each method is queried by calls_to(&#60;method name&#62;) instead of calls_to_&#60;method_name&#62;. A bit less magic.</p>
<strong>call_foo.rb:</strong><pre lang='ruby'>

require "call_counter"

class CallFoo
	
  extend CallCounter

  def foo; "foo"; end
  def bar; "bar"; end

  count_calls_to :foo
  count_calls_to :bar

end
</pre><strong>(a snippet of) call_counter_spec.rb:</strong><pre lang='ruby'>
require "call_foo"
require "spec"
	
describe CallFoo do
	
  before(:each) do
    @call_foo = CallFoo.new
    CallFoo.reset_counters
  end
		
  it "should be able to count several methods' calls" do
    4.times { @call_foo.foo }
    CallFoo.calls_to(:foo).should == 4
    7.times { @call_foo.bar }
    CallFoo.calls_to(:bar).should == 7
  end
	
end
</pre>
<p>I&#8217;m still not 100% content with this solution, the programming interface is nice now but it would be cool to get rid of the class variable somehow, possibly replacing it with closures. If you know how to achieve it, please leave a comment.</p>

<p>ps. You can also get <a href='http://pastie.org/338877'>the whole code in nice colored format</a> or <a href='http://pastie.org/338877.txt'>the raw text version</a>.</p>
    <a href="/2008/12/15/ruby-metaprogramming-call-counter-take-2.html" title="Ruby metaprogramming: Call counter - Take 2">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/12/06/exploring-ruby-metaprogramming-call-counter.html">Exploring Ruby metaprogramming: call counter</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/12/06/exploring-ruby-metaprogramming-call-counter.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>A few days ago I purchased a <a href='http://www.pragprog.com/screencasts/v-dtrubyom/the-ruby-object-model-and-metaprogramming'>screencast by Dave Thomas on Ruby metaprogramming</a>. (I do not receive any affiliation fees :)). The part I bought presents a problem and describes nine different ways of solving it in ascending order of beauty and code clarity.</p>

<p>I was stunned by its beauty so I came up with another -though similar- problem and put together a simple solution for it. I present it for the Rubyists to silently smile in the knowledge of its elegance and power and for non-Ruby programmers to be -hopefully :)- amazed by it.</p>

<p>The task is to count the calls to a certain method of all instances of a class.</p>

<p>call_counter.rb: <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;ruby&quot;&gt;
module CallCounter
  def count_calls_to(method_name)
  	original_method = instance_method(method_name)</pre></p>

<pre><code>call_counter = 0
define_method(method_name) do |*args|
	call_counter += 1
	bound_original_method = original_method.bind(self)
	bound_original_method.call(*args)
end

define_method &quot;calls_to_#{method_name}&quot; do
	call_counter
end		</code></pre>

<p>end end &lt;/pre&gt;</p>

<p>call_foo.rb: <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;ruby&quot;&gt;
require &quot;call_counter&quot;</pre></p>

<p>class CallFoo</p>

<pre><code>extend CallCounter

def foo; end
count_calls_to :foo</code></pre>

<p>end &lt;/pre&gt;</p>

<p>After calling &#8220;count_calls_to :foo&#8221; in the CallFoo class definition, calls to the &#8220;foo&#8221; method of CallFoo instances will be counted. A &#8220;calls_to_foo&#8221; method is available to get this count.</p>

<p>I first created an UnboundMethod with &#8220;instance_method&#8221; and then used the bind method to attach it to an instance of ClassFoo. All this is to prevent aliasing method names, not because it is necessarily evil but because I agree with Dave Thomas about &#8220;bind&#8221; being a nicer solution. The define_method acts as a closure and saves its context so there is no need to use an instance variable for call_counter.</p>

<p>You can use the counter like this:</p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;ruby&quot;&gt;
irb(main):003:0&gt; cf = CallFoo.new
=&gt; #&lt;CallFoo:0x608100&gt;
irb(main):004:0&gt; cf.calls_to_foo
=&gt; 0
irb(main):005:0&gt; 4.times { cf.foo }
=&gt; 4
irb(main):006:0&gt; cf.calls_to_foo
=&gt; 4
&lt;/pre&gt;</pre>
<p>Once again, what I love about Ruby is that in ~ 20 lines we have laid the base of a benchmarking tool (adding the possibility of measuring time spent in the method would not be hard). Also, the original class is not sullied by the call counting code intrinsic details. That functionality is stashed in a module, eager to be reused again.</p>

<p>You may note there is something not quite nice about this. The method calls are counted per class, which makes sense since we usually want to know how many times the method in question was called in all instances, not per instance. However, the calls_to_foo is called on the instance which is confusing. It should be called on the class object, like this:</p>
<pre lang='ruby'>
  4.times { cf.foo }
  CallFoo.calls_to_foo
  => 4
</pre>
<p>I may get back to this later.</p>
    <a href="/2008/12/06/exploring-ruby-metaprogramming-call-counter.html" title="Exploring Ruby metaprogramming: call counter">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/12/04/a-git-guide-that-emboldens.html">A Git guide that emboldens</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/12/04/a-git-guide-that-emboldens.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Git is extremely powerful. I knew that much and that I would really like to thoroughly master it because it is so cool. However, it is quite sophisticated (not to mention that some commands, like checkout and revert designate totally different actions than in Subversion where I am coming from) and like with most things one learns by doing.</p>

<p>One key to doing is the ability to play around with a git repository. The possibility to have an account on <a href='http://github.com'>github.com</a> and to contribute to a myriad of open source projects there removed that obstacle. The other ingredient to be a master chef is a good guide in the subject. One needs some initial self-confidence to know what he is doing lest he screws up his own work. (Note: that is very hard with git but I remember the panic when I did &#8220;git checkout &#60;earlier commit&#62;&#8221; and I did not find my earlier HEAD with &#8220;git log&#8221; )</p>

<p>We may be different but I have not read a really insightful guide albeit I have gone through a dozen of them. Some are too vague or concentrate on one specific task (e.g how to create a repo on github and push to it) and some present too many options and go into details that intimidate the novice. (like the official man pages). Ladies and gentlemen, I have found it. It&#8217;s the <a href='http://www.kernel.org/pub/software/scm/git/docs/user-manual.html'>Git User's Manual</a> and it strikes the perfect balance between verbosity and shallowness. It gives examples which nicely clarify the concepts. It won&#8217;t make you an expert right away, of course, but it provides you with the insight and initial courage to embark on the journey.</p>
    <a href="/2008/12/04/a-git-guide-that-emboldens.html" title="A Git guide that emboldens">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/11/28/installing-rmagick.html">Installing rmagick</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/11/28/installing-rmagick.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I needed to install rmagick for a Rails project. I had some amount of trouble along the way but finally succeeded so I am sharing my experience in case you bump into the same problems.</p>

<p>I first installed the <a href='http://imagemagick.linux-mirror.org/download/www/binary-releases.html#macosx'>binary OS-X distribution of imagemagick</a> (no problems here) and then attempted to install rmagick, the ruby interface to the ImageMagick libraries:</p>
<pre lang='shell'>
sudo gem install rmagick
</pre>
<p>However, I received the following unpleasant error:</p>
<pre lang='shell'>
Can't install RMagick 2.7.2. Can't find MagickCore.h.
</pre>
<p>I checked that the header file is there (on the path the install script was looking for it), and decided not to go the hard way. After some googling I found there is a <a href='http://rubyforge.org/projects/rmagick/'>rmagick-osx-installer</a> which downloads, compiles and installs ImageMagick and rmagick. Just what I needed.</p>

<p>However, the script failed to accomplish its mission, it hung when installing rmagick. Taking a peak in its log I saw several other errors so I had to look for another way. And that way was compiling the ImageMagick library myself. So I downloaded <a href='http://imagemagick.linux-mirror.org/download/www/install-source.html#unix'>the source</a>, made the configuration-make-make install cycle and fortunately everything went smoothly. The good news is I could install rmagick without any problem after that:</p>
<pre lang='shell'>
balint$ sudo gem install rmagick
Building native extensions.  This could take a while...
Successfully installed rmagick-2.7.2
1 gem installed
</pre>
    <a href="/2008/11/28/installing-rmagick.html" title="Installing rmagick">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/11/17/refuting-rails-myths.html">Refuting Rails myths</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/11/17/refuting-rails-myths.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>David Heinemeier Hansson, the creator of Rails is doing an <a href='http://loudthinking.com/posts/29-the-rails-myths'>outstanding series of blog posts</a> on <a href='http://loudthinking.com/'>his blog</a> to derail (pun intended) some common myths that claim Rails does not do this or that and that hinders (or rather, slows down) its widespread acceptance.</p>

<p>I am sure David holds his best for last and will refute the infamous &#8220;Rails does not scale&#8221; in the final episode of the series.</p>
    <a href="/2008/11/17/refuting-rails-myths.html" title="Refuting Rails myths">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/11/17/conferenciarails-2008-enhorabuena.html">ConferenciaRails 2008: enhorabuena!</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/11/17/conferenciarails-2008-enhorabuena.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I have just returned from Madrid where the Spanish Rails Conference, <a href='http://www.conferenciarails.org/'>Conferencia Rails</a> was held. I liked it quite a lot, there were several interesting talks most of which made me want to learn all of that and very fast (one thing conferences do to me is to boost that healthy feeling of wanting to always learn and discover new things). So I would like to add my e-voice to the web noise: congratulations and thank you to the organizers and presenters!</p>
    <a href="/2008/11/17/conferenciarails-2008-enhorabuena.html" title="ConferenciaRails 2008: enhorabuena!">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/10/26/blackbird-simple-log-messages-in-javascript.html">Blackbird - simple log messages in Javascript</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/10/26/blackbird-simple-log-messages-in-javascript.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>Using alert() for debugging javascript is a pain. <a href='https://addons.mozilla.org/en-US/firefox/addon/1843' target='_blank'>Firebug</a> makes it a lot easier and enables several debug facilities (e.g inserting breakpoints, stepping into methods, adding variable watches) but a painless logging mechanism would still be very useful to supplement Firebug&#8217;s features.</p>

<p>Enter <a href='http://bucionrails.com/http://www.gscottolson.com/blackbirdjs/' title='Blackbird' target='_blank'>Blackbird</a>, a simple javascript logging tool which has a very clean, nice API and a cool console. It&#8217;s really worth to check out, you can download the Blackbird files <a href='http://blackbirdjs.googlecode.com/files/blackbirdjs-1.0.zip' target='_self'>here</a> and my demo <a href='http://bucionrails.com/wp-content/uploads/2008/10/blackbird_trial.html'>here</a> to try out its features. (If you use my demo, you have to save the Blackbird files in a directory named blackbirdjs that is situated in the same directory as the demo page)</p>

<p>Blackbird&#8217;s motto says it all: say &#8220;hello&#8221; to Blackbird and &#8220;goodbye&#8221; to alert().<a href='http://bucionrails.com/wp-content/uploads/2008/10/blackbird_trial.html'>
</a></p>
    <a href="/2008/10/26/blackbird-simple-log-messages-in-javascript.html" title="Blackbird - simple log messages in Javascript">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/10/22/postgresql-pg_hbaconf-authentication.html">PostgreSQL pg_hba.conf authentication</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/10/22/postgresql-pg_hbaconf-authentication.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I recently spent some time debugging while I can&#8217;t connect to a local postgreSQL database. I wanted the nice_db database to be accessible to all local users (not real names) without any authentication. The &#8220;trust&#8221; authentication method was what I needed for this scenario, I was sure of this much. So I set up an authentication record in the configuration file below the one that existed by default: <pre lang='sql'># TYPE  DATABASE    USER    CIDR-ADDRESS    METHOD
local    all          all                   ident sameuser
local    nice_db      all                   trust</pre> But this gave me the following error and denied access:</p>

<p>psql: FATAL:  Ident authentication failed for user &#8220;balint&#8221;</p>

<p>I tried several things making the second record more allowing each time (in fact, what you see above is the final, most liberal version) to no avail. I then swapped the order of the two records and finally was granted access.</p>

<p>Of course, I should have been wiser and apply the grand old <acronym title='Read The Fucking Manual'>RTFM</acronym> principle. The <a href='http://www.postgresql.org/docs/7.4/static/client-authentication.html' title='PostgreSQL documentation' target='_blank'>PostgreSQL documentation</a> states in very clear terms how each line in the pg_hba.conf is accessed: <blockquote>The first record with a matching connection type, client address, requested database, and user name is used to perform authentication. There is no <span class='QUOTE'>"fall-through"</span> or    <span class='QUOTE'>"backup"</span>: if one record is chosen and the authentication fails, subsequent records are not considered. If no record matches, access is denied.</blockquote> For my particular case, the &#8220;local all all ident sameuser&#8221; record blocked access to all databases but to those whose name matched that of the operating system&#8217;s user (that&#8217;s what the ident sameuser does) since that matches all user and database names.</p>

<p>Beyond the mechanics of PostgreSQL authentication (put the authentication records that match more users/databases below the ones that are more specific), I have learned something which is more precious and that I can put into good use in the future: RTFM!</p>
    <a href="/2008/10/22/postgresql-pg_hbaconf-authentication.html" title="PostgreSQL pg_hba.conf authentication">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/10/09/javascript-method-chain.html">javascript method chain</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/10/09/javascript-method-chain.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>John Resig has an extraordinary advanced javascript tutorial on his <a href='http://ejohn.org/apps/learn/' target='_blank'>blog</a> that he presented on <a href='http://en.oreilly.com/webexny2008/public/content/home' target='_blank'>a web conference</a>. It is definitely worth a walk-through since it expands one&#8217;s javascript horizon unless one has not written a javascript framework himself.</p>

<p>I played around with several of his slides learning a lot. My favorite was probably <a href='http://ejohn.org/apps/learn/#90'>the last slide</a> which explains how method overloading works using the fact that <em>methodname</em>.length in javascript gives back the number of expected arguments of that function.</p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;javascript&quot;&gt;
function addMethod(object, name, fn){ 
  // Save a reference to the old method 
  var old = object[ name ];
 
  // Overwrite the method with our new one 
  object[ name ] = function(){ 
    // Check the number of incoming arguments, 
    // compared to our overloaded function 
    if ( fn.length == arguments.length ) 
      // If there was a match, run the function 
      return fn.apply( this, arguments ); 
 
    // Otherwise, fallback to the old method 
    else if ( typeof old === &quot;function&quot; ) 
      return old.apply( this, arguments ); 
  }; 
} 
 
function Ninjas(){ 
  var ninjas = [ &quot;Dean Edwards&quot;, &quot;Sam Stephenson&quot;, &quot;Alex Russell&quot; ]; 
  addMethod(this, &quot;find&quot;, function(){ 
    return ninjas; 
  }); 
  addMethod(this, &quot;find&quot;, function(name){ 
    var ret = []; 
    for ( var i = 0; i &lt; ninjas.length; i++ ) 
      if ( ninjas[i].indexOf(name) == 0 ) 
        ret.push( ninjas[i] ); 
    return ret; 
  }); 
  addMethod(this, &quot;find&quot;, function(first, last){ 
    var ret = []; 
    for ( var i = 0; i &lt; ninjas.length; i++ ) 
      if ( ninjas[i] == (first + &quot; &quot; + last) ) 
        ret.push( ninjas[i] ); 
    return ret; 
  }); 
} 
 
var ninjas = new Ninjas(); 
assert( ninjas.find().length == 3, &quot;Finds all ninjas&quot; ); 
assert( ninjas.find(&quot;Sam&quot;).length == 1, &quot;Finds ninjas by first name&quot; ); 
assert( ninjas.find(&quot;Dean&quot;, &quot;Edwards&quot;).length == 1, &quot;Finds ninjas by first and last name&quot; ); 
assert( ninjas.find(&quot;Alex&quot;, &quot;X&quot;, &quot;Russell&quot;) == null, &quot;Does nothing&quot; );
&lt;/pre&gt;</pre>
<p>It took me some time to figure out how exactly the method calls are routed but it was an interesting process nevertheless. I guess the one tricky part to interpret is the following bit: <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;javascript&quot;&gt;
if ( fn.length == arguments.length ) 
  // If there was a match, run the function 
  return fn.apply( this, arguments ); </pre></p>

<p>// Otherwise, fallback to the old method else if ( typeof old === &#8220;function&#8221; ) return old.apply( this, arguments ); }; &lt;/pre&gt;</p>

<p>This makes a method chain and allows for method overloading. With the three addMethod calls in the above example a chained method is built up.</p>

<p>After the call to addMethod with no arguments (the first one), the find method of the Ninjas &#8220;class&#8221; will return all ninjas if called with no arguments and do nothing if called with any number of arguments. After the call to addMethod with one single name argument the find method will return the ninjas whose first name matches the passed argument if there is only one argument, return all ninjas if it has been called with no arguments and do nothing otherwise.</p>

<p>I could go on but the pattern is probably clear now. At each call of the find method, the lastly added method is matched for the number of arguments (so in the above example, it will match if the caller passed two arguments) and the method called if the match is successful. Otherwise, it will try to match the number of arguments with the method that was added before the last one, and so on.</p>

<p>I am elaborating this in so much detail because <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;ol&gt;
	&lt;li&gt;it was such a &quot;Eureka!&quot; moment for me when I got it. &lt;/li&gt;
	&lt;li&gt;it is an incredibly ingenious way to flex the possibilites of javascript and introduce an OOP concept into an originally non-OOP language.&lt;/li&gt;</pre></p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;/ol&gt;</pre>
<p>I think John Resig made javascript lovable again which is why he deserves my total gratitude.</p>
    <a href="/2008/10/09/javascript-method-chain.html" title="javascript method chain">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/09/21/my-first-dsl-in-ruby.html">My first DSL in Ruby</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/09/21/my-first-dsl-in-ruby.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I read a <a href='http://www.artima.com/rubycs/articles/ruby_as_dsl.html'>few</a> <a href='http://www.artima.com/rubycs/articles/ruby_as_dsl.html'>posts</a> about how good fit Ruby is for building DSLs, Domain Specific Languages. Ever the curious I have been waiting for the opportunity to build a very simple one for a particular problem.</p>

<p>Well, I did not have to wait very long (when you have a hammer everything looks like a nail). I needed a quick method which generates nice html graphs for <a href='http://bucionrails.com/2008/09/17/v8-javascript-engine-benchmarks/'>my post about browser javascript engine benchmarking</a>. After spending a few minutes searching for a free tool (I did not want anything fluffy, just something very basic) I hit the nail in the head with my hammer. Only the nail was the generated HTML charts for my post and the hammer, (my desire to build) a DSL in Ruby.</p>

<p>I would like to say it was difficult but in fact it was a piece of cake with Ruby (and armed with the knowledge of previous DSL builders). The solution is composed of the following three parts:</p>
<ol>
	<li>The DSL file which defines the charts</li>
	<li>The interpreter which understands the definitions in the DSL file</li>
	<li>The "controller" which just passes the data contained in the DSL file to the interpreter</li>
</ol>
<p>So let&#8217;s see each part separately:</p>
<strong>browser_js_benchmarks.dsl (the DSL)</strong><pre lang='ruby'>
chart "Score" do |c|
	c.add "Safari 3.1.2" => 164
	c.add "Firefox 3.0.1" => 156
	c.add "Shiretoko" => 145
	c.add "Google Chrome" => 1589
end
</pre><strong>chart.rb (the interpreter)</strong><pre lang='ruby'>
require "math_aux"

class ChartDSL
	
	Template = %(<table cellspacing='5' border='0' cellpadding='5'><caption>%%CAPTION%%</caption>%%ITEMS%%</table>)
	Background_colors = %w(red blue green yellow grey)
	
	attr_reader :values
	def initialize
		@charts = Array.new
		@values = Hash.new
	end
	
	def chart(name)		
		@name = name
		yield self
		@charts.push(make_html)
	end
	
	def add(name_and_value)
		@values ||= Hash.new
 		@values.merge!(name_and_value)
	end
	
	def load(filename)
		# c = new
		instance_eval(File.read(filename), filename)
		write_output
	end

	def make_html
		sorted_pairs = @values.sort_by { |v| - v[1] }
		vals = sorted_pairs.map { |p| p[1] }
		norm_values = MathAux::normalize(vals, 100.0)
		html = Array.new
		sorted_pairs.each_with_index do |pair, i|
			name, value = pair
			html.push(%Q(<tr><td>#{name}</td><td><div style='width:#{norm_values[i]}px;background-color:#{ChartDSL::Background_colors[i]}'>&nbsp;</div></td><td>#{value}</td></tr>))
		end
		filled_chart = ChartDSL::Template.sub("%%CAPTION%%", @name)		
		filled_chart.sub("%%ITEMS%%", html.join)
	end
	
	def write_output
		File.open("generated_charts.html", "w") do |f|
			f.write(@charts)
		end
	end
end

</pre><strong>chart_loader.rb (the controller)</strong><pre lang='ruby'>
require "chart"
class ChartLoader
	def self.load_chart(dsl_filename)
		c = ChartDSL.new
		c.load(dsl_filename)
	end
end

if __FILE__ == $0
	ChartLoader.load_chart(ARGV[0])
end
</pre>
<p>For the sake of completeness here is <strong>math_aux.rb</strong>: <pre lang='ruby'>
module MathAux
	def self.normalize(numbers, to=1.0)
		norm_rat = to / numbers.max
		numbers.map { |n| n * norm_rat }
	end
end
</pre></p>

<p>To generate the charts, one only has to run &#8220;the interpreter&#8221; with a dsl file as the first parameter:</p>
<pre lang='ruby'>
ruby chart_loader.rb browser_js_benchmarks.dsl
</pre>
<p>The output is called generated_charts.html and contains the following: &lt;pre lang=&#8221;xml&#8221;&gt; &lt;table border=&#8221;0&#8221; cellspacing=&#8221;5&#8221; cellpadding=&#8221;5&#8221;&gt; <caption>Score</caption> <tr>
  <td>Google Chrome</td>
  <td><div style='width:100.0px;background-color:red'>&nbsp;</div></td>
  <td>1589</td>
 </tr> &lt;tr&gt; <td>Safari 3.1.2</td> &lt;td&gt;<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;div style=&quot;width:10.3209565764632px;background-color:blue&quot;&gt;&amp;nbsp;&lt;/div&lt;/td&gt;</pre> <td>164</td>&lt;/tr&gt; &lt;tr&gt; <td>Firefox 3.0.1</td> &lt;td&gt;<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;div style=&quot;width:9.81749528005034px;background-color:green&quot;&gt;&amp;nbsp;&lt;/div&lt;/td&gt;</pre> <td>156</td> &lt;/tr&gt; &lt;tr&gt; <td>Shiretoko</td> &lt;td&gt;<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;div style=&quot;width:9.12523599748269px;background-color:yellow&quot;&gt;&amp;nbsp;&lt;/div&lt;/td&gt;</pre><td>145</td> &lt;/tr&gt; &lt;/table&gt; &lt;/pre&gt;</p>

<p>Note that in ~30-40 code lines we have a &#8220;language interpreter&#8221;, one that understands the chart DSL and spits out some HTML code that represents the charts. Of course there is plenty of room for improvement, like having the same color denote the same actor between charts (Firefox 3.0.1 should always be the blue bar, for example, unlike in <a href='http://bucionrails.com/2008/09/17/v8-javascript-engine-benchmarks/'>my post</a>), using a better solution for the template strings, adding the possibility of pie charts (although &#8220;standard&#8221; HTML is not very flexible on different chart forms, one would probably have to use a <a href='http://developer.mozilla.org/en/Canvas_tutorial'>&lt;canvas&gt; </a>), and so on.</p>

<p>The essential thing is that it works and it does what the particular situation demanded. It took me a couple of interrupted hours plus the time to read through two related posts which is not that much given that I now have a &#8220;tool&#8221; (once again, I feel a bit conceited to call it that) which I can use for my future posts whenever the need arises. A custom hammer for my custom nail.</p>

<p>(If you care, feel free to download, use and modify the source code located <a href='http://github.com/balinterdi/chart-maker-dsl/tree/master'>here</a>)</p>
    <a href="/2008/09/21/my-first-dsl-in-ruby.html" title="My first DSL in Ruby">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/09/17/v8-javascript-engine-benchmarks.html">V8 javascript engine benchmarks</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/09/17/v8-javascript-engine-benchmarks.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>A few weeks back when I read about <a href='http://www.google.com/googlebooks/chrome'>Chrome</a> I became interested in V8, a javascript engine that Google integrated in their browser and that they claimed to be very fast due to the following reasons:</p>
<ul>
	<li><strong>Hidden class transitions</strong> that enable dynamic optimizations since objects will use the same (hidden) class</li>
	<li><strong>generating machine code</strong> instead of interpreting the source code each time</li>
	<li><strong>incremental garbage collection</strong> which reduces the time needed for the cleanup to milliseconds and eliminates "second long pauses"</li>
</ul>
<p>All that sounded very promising but as an engineer by profession it left me with a desire to find out how much faster all these features made V8 (and any browser that might use it). Even more so since I love running benchmarks and compare numbers. Well, maybe Google sensed that since they provided all the necessary tools to run these tests on the <a href='http://code.google.com/apis/v8/benchmarks.html'>V8 benchmark page</a> and to run them very easily.</p>

<p>There are 5 different algorithms in the testing suite exercising different qualities of the javascript engine. To be fair I closed all other tabs in browsers during the testing attempting to minimize operations that can have an effect on test performance. Also, the V8 tests were run from the command line so that might skew the results a bit towards V8. Anyyway, here are the results (numbers mean execution time so smaller is better):</p>
<table cellspacing='5' border='0' cellpadding='5'><caption>Richards</caption><tr><td>Google Chrome</td><td><div style='width:100.0px;background-color:red'>&nbsp;</div></td><td>2072</td></tr><tr><td>Firefox 3.0.1</td><td><div style='width:7.33590733590734px;background-color:blue'>&nbsp;</div></td><td>152</td></tr><tr><td>Shiretoko</td><td><div style='width:5.5984555984556px;background-color:green'>&nbsp;</div></td><td>116</td></tr><tr><td>Safari 3.1.2</td><td><div style='width:4.39189189189189px;background-color:yellow'>&nbsp;</div></td><td>91</td></tr></table>
<p>The superiority of V8 stunned me so much even to push me to ask whether all this is possible. Googe Chrome that uses V8 is on average (see Score) 10 times faster than all the other browsers (that pretty much flock together). I expected to find the speed of Firefox 3.1 (codename Shiretoko) close to that of Chrome but to my surprise it does not even surpass that of the other browsers. That made me a bit disappointed since I am a big Firefox fan.</p>

<p>Can it be that these benchmarks are somehow tailored to show V8&#8217;s dominance? (like some political polls are skewed to give the &#8220;correct&#8221; answer). That this is not such a far-fetched idea is supported by Mozilla&#8217;s announcement that TraceMonkey, <a href='http://www.techcrunch.com/2008/09/03/mozilla-fights-back-with-new-firefox-benchmarks/'>Firefox's javascript engine will be 16-28% faster than V8</a>. And they have their own benchmarking solution, SunSpider to prove their point.</p>

<p>So the life of javascript engine developers has got a lot harder. Not only they have to implement a fast engine but also a benchmarking system that shows there is nothing as fast as theirs!</p>
    <a href="/2008/09/17/v8-javascript-engine-benchmarks.html" title="V8 javascript engine benchmarks">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/09/03/navigator-for-the-google-chrome-comicbook.html">Navigator for the Google Chrome comicbook</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/09/03/navigator-for-the-google-chrome-comicbook.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>The first beta version (for now only for Windows) of <a href='http://googleblog.blogspot.com/2008/09/fresh-take-on-browser.html'>Google's browser is out, </a>but I don&#8217;t think Google needs the marketing power of my post so that&#8217;s not what I want to talk about. The browser is introduced by a <a href='http://www.google.com/googlebooks/chrome/'>ingenious comics</a> of 39 pages. However, the navigator is too simple, in my opinion in that you cannot skip a page so if you read until say page 19 and you have to start over (e.g you closed the browser), you have to click on the &#8220;Next&#8221; link 18 times. There is no unique URL for each page, the whole navigation is done with a javascript snippet changing the image (the cartoon strip) when the user clicks &#8220;Prev&#8221; or &#8220;Next&#8221;.</p>

<p>So I took a peep at the source of the page and reverse-engineered the navigation which is simply a javascript call to goPage(&#8216;next&#8217;) when the user clicks the Next link. So now I can simply write</p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;javascript&quot;&gt;
javascript:for (var i=0; i &lt; 10; i++) goPage(&apos;next&apos;);&lt;/pre&gt;

to the location bar to skip 10 pages ahead and do the same with &apos;prev&apos; to rewind 10 pages.

I know &quot;reverse-engineering&quot; is way too conceited a term for this but this kind of hacking tickles my brain in a very joyful way and feels a bit like outsmarting Google. And that&apos;s not bad at all.

&lt;strong&gt;UPDATE:&lt;/strong&gt; I now realize the comics&apos;s navigation has been redesigned so my above fix became obsolete. At least I cherish the knowledge my hack addressed a real UI problem (and did that faster than Google :) ).</pre>
    <a href="/2008/09/03/navigator-for-the-google-chrome-comicbook.html" title="Navigator for the Google Chrome comicbook">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/08/29/now-thats-what-i-call-web20-ubiquity.html">Now that's what I call Web2.0: Ubiquity</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/08/29/now-thats-what-i-call-web20-ubiquity.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I&#8217;ve stumbled upon a great Firefox plugin, Ubiquity. It basically accesses several web services (GoogleMaps, Gmail, Flickr, etc.) via its own panel and with its own commands so that common online tasks (e.g looking up something on Wikipedia you have just found on a page) become amazingly simple. I was really stunned by how much this plugin is capable of doing after watching the <a href='http://vimeo.com/1561578?pg=embed&amp;sec=1561578' target='_blank'>briefing video</a> and going through the <a href='https://wiki.mozilla.org/Labs/Ubiquity/Ubiquity_0.1_User_Tutorial' target='_blank'>tutorial</a>. And that does not stop there: power users can add their own commands to extend the already vast capabilities of the plugin. It&#8217;s been a long time I&#8217;ve been so excited about a &#8220;web 2.0&#8221; tool.</p>
<a href='http://www.azarask.in/blog/' target='_blank'>Here</a><em>Note</em>
    <a href="/2008/08/29/now-thats-what-i-call-web20-ubiquity.html" title="Now that's what I call Web2.0: Ubiquity">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/07/17/can-less-work-be-more.html">Can less work be more?</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/07/17/can-less-work-be-more.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I saw the <a href='http://onrails.org/articles/2008/05/31/railsconf-2008-david-heinemeier-hanssons-keynote-video'>keynote speech David Heinemeier Hansson</a> gave at this year&#8217;s Railsconf in Portland and I liked it a lot. I really like the idea of following the pattern of &#8220;Less software is more&#8221; to the work we do each day. In his speech he says developers should spend one day a week discovering a subject of interest, writing code for a pet project, contributing to an open source project, etc. Basically anything but doing the work they do on the other four days of the week. This &#8220;day-off&#8221; raises the developer&#8217;s productivity so it is a net gain for the main work he is involved with, too.</p>

<p>I tend to agree. However, in this post I want to elaborate rather what &#8216;be more&#8217; means in both the &#8216;less software is more&#8217; and the &#8216;less work is more&#8217; phrases. Less software means less lines of code to achieve the same tasks. Less work means less time spent working producing code to achieve the same tasks. There are two underlying concepts here that make this possible: abstraction and productivity. More precisely: the ideas in your (hacker) head and the tools that allow you to implement these ideas in abstract, high-level terms and thus raise your productivity.</p>

<p>When you write a program, there are basically two phases of producing code that solves a problem: first, you think about how to solve it and second, you convert the ideas into code. There is always a gap between the ideas and the code you write and that the computer comprehends. The more high-level the language is, the smaller the gap that needs to be bridged. But there is a backward effect, too. Usually when you are in the first phase you already think in terms of the second. The expressive tools the language provides have a strong effect on how you think of the problem (generally you know what language your solution will be implemented in). And that is bad because it dumbs down your thinking before you get to the point where you should consider the possibilities of the language.</p>

<p>I tend to think less of the language specifics in the first phase if I know the language provides all the high-level tools and provides them neatly. &#8220;For&#8221; loops skews your thinking more than -all kinds of- iterators. If I know functions are first-class objects and metaprogramming is available I worry less about how (or whether!) my abstract solution, only existing on the plane of ideas can be converted to functioning code.</p>

<p>So, back to where I started, your choice of the language counts and it counts a lot. It can help you be more productive in several ways, not just the fewer-lines-of-code-to-do-the-same-thing way but also the minimizing-the-skewing-of-your-thinking way. However, a high-level language is no guarantee to achieve that. One can churn out C-like code in Ruby, it is just easier to realize you are not using the full arsenal. And that&#8217;s where it really kicks in: if you know you can basically do anything painlessly you will dare to think big, your ideas can get off the ground. Consequently they will be abstract enough for you to be more productive.</p>

<p>So armed with daringly abstract ideas and tools that make it possible to put them into code, one sets out to conquer the world. The limit to the amount of code generated is the number of hours one can spend each day programming. After about ~8 hours of work is it worth to put in some more time to produce more code? <a href='http://www.extremeprogramming.org/rules/overtime.html'>Probably not</a>. Our thinking breaks down pretty fast after that. I have experienced on several occasions that I could do in 10 minutes the next morning what I could not do in 2 hours the evening before. This is not about dropping the keyboard when the clock strikes 5pm, of course. It is about <a href='http://www.extremeprogramming.org/rules/velocity.html'>planning for measurable progress without too much overtime</a>.</p>

<p>I think David is right when asserting that replenishing your mind so it can come up with constructive ideas is equally important. I am sure there are numerous ways to attain that. Some of them are constructive activities in themselves (David&#8217;s example was playing the banjo), some may just give you peace (e.g friends, family) and some may simply drift your thoughts away from the very problem you are working on (e.g playing soccer) and help you that way.</p>

<p>So what do you think about all that? Can low-level languages still have advantages over high-level ones in certain situations? Do you think the language your are programming in can have an effect on your problem-solving thoughts? What activities switch you off in the most &#8220;productive&#8221; way? What other factors have an effect on your work? (of course your working environment is very relevant). Are <a href='http://www.boston.com/bostonglobe/ideas/naps/'>naps </a>worth it? When would the official Railsconf&#8217;08 videos be online? :)</p>
    <a href="/2008/07/17/can-less-work-be-more.html" title="Can less work be more?">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/05/27/first-mac-experiences.html">First Mexperiences</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/05/27/first-mac-experiences.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I recently wrote <a href='http://bucionrails.com/2008/05/22/confession-of-a-conversion/'>about me getting a Mac</a>, the reasons I made the switch and how I really like it. I would now like to add nuances to this overall picture. What is really cool? What is hard to get used to? Which are the things I could not find how to achieve on the Mac?</p>
<h3>Non-keyboard input</h3>
<p>I think I am one of the few who prefers the trackball (Thinkpad-style) to trackpads. For me, trackpads are clumsy, it is hard to position the cursor correctly, they make an incomfortable sound and I often click inadvertently by pushing too hard (but not hard at all). So I had thought I&#8217;d get a mouse but then I found out the usb ports are located on the left hand side of the Macbook which does not seem to logical unless Apple specifically targeted left-handed people. Or does everyone already have cordless mice?</p>

<p>Anyway, I gave the trackpad a try and I was thoroughly satisfied. The trademark two-finger scrolling works miracle, clicking is silent and the trackpad is wide enough to be able to lay two-fingers on the pad and click with my thumb which serves as a right-click. Absolutely phenomenal. My plans to acquire a cordless mouse have been postponed. (Even more so since I learned from a colleague that to really get the best out of the mouse you need to <em>purchase</em> a driver. I can imagine paying for software, but for a mouse driver? that seems harsh.)</p>
<h3>Managing windows and menus</h3>
<p>Having said all about non-keyboard input I always try to minimize the time I have to lift my hands from the keyboard in all applications. Switching between applications is easy with cmd+tab and I also learned the cmd+<code> and cmd+~ which switches between windows of the same application and is very useful. Closing an application with cmd+q and a tab/window with cmd+w also come in handy and was easy to learn. However, one thing which I miss badly is a key combination to just go to the menu and browse there (e.g alt+f1 in gnome). I mean there are several combinations to activate certain menu items but if I do not want to learn a few dozens of them per application it seems a good idea to me to have just one and then be able to access everything. Or maybe there is, waiting for me to discover it.</code></p>
<h3>Command line boosters</h3>
<p>Another feature I adore in the terminal is to be able to quickly navigate. Go to the start, to the end, skip a word forwards, backwards, delete a word, etc. One extra advantage of my favorite text editor, emacs, is that its combinations coincide with those used on the command line, which is fantastic. After a while, I learned that they can all be invoked in Mac terminals, too, it is just that they seem less logical too me. For example , Esc-D is to delete from the cursor to the end of the word, why is Ctrl-W Delete the word to the left of the cursor? (found <a href='http://ie.brokethe.net/2008/2/6/mac-terminal-shortcuts'>here</a>). Also, Esc is too far away to reach comfortably. I know iTerm can be programmed to respond to any key combination, so I might do some tinkering here to have a more consistent interface.</p>
<h3>Installing software</h3>
<p>Getting applications installed on your computer is quite easy with the disk image installers or one can always compile from source the advantages of which are described <a href='http://hivelogic.com/articles/2005/11/using_usr_local'>in this excellent article</a>. I have to tell that the provided applications are really top notch like iTunes or iPhoto, and I haven&#8217;t even had the time to try all of them (iMovie, Garage Band, etc.). One caveat is that some applications, like iPhoto treats your data as one big library file so you need to export particular files if you need them outside of the application (how do you upload individual photos to a photo company&#8217;s site to have them developed? how do you upload an image to a photo-sharing website? you&#8217;ll need plugins or you have to export them thus duplicating the photos and wasting space). This surely suits ordinary users but advanced, tech-savvy users don&#8217;t like this kind of obfuscation, or at least I don&#8217;t.</p>

<p>A big pain for me is the presence of spaces in directory names. It may be an old habit to automatically evade them but it looks amateurish to me. Which Mac (and OS/X) is certainly not. It is a great machine (and operating system) to have.</p>
<strong>Post scriptum.</strong><strong>Update</strong>
    <a href="/2008/05/27/first-mac-experiences.html" title="First Mexperiences">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/05/22/confession-of-a-conversion.html">Confession of a conversion</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/05/22/confession-of-a-conversion.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>My company laptop has gotten old and weary. So old that I could not even find a replacement battery and some memory for it. I could, but for half a price of a shiny new notebook that is three times stronger. I liked my old laptop, but not that much. So I went looking for a new one. I was hesitating between a Thinkpad and an ASUS since I was pretty content with both of them but the faint voice was already whispering into my ear: &#8220;get a Mac, get a Mac&#8221;.</p>

<p>I&#8217;ll admit the sysadmin side of things is not my favorite part of working with a computer. I have nothing against modifying configuration files, installing software from the command line and the like but I do feel like I am wasting my time when trying to get Skype voice to work for several hours to no avail, make my laptop &#8220;soft-hibernate&#8221; when I close the lid (I got that one, finally) or set up the wifi hotspot selector icon. I know it is just a matter of time and perseverance and I like the idea that you can get it to work if you finally understand what needs to be tweaked and how. (In fact, most of the time you don&#8217;t. You just find the answer by searching on Google, copy-paste something you don&#8217;t understand and eureka, it works.). It is just that my priorities lie elsewhere. It has been said a million times but it is still true: time is too precious to spend on anything but the most important things. For me, these are writing code, learning software, discovering new tools and technologies.</p>

<p>There was something more in favor of a Mac: its design. I don&#8217;t primarily mean the physical design of the laptop though in my opinion it is the <a href='hhttp://www.apple.com/macbook/design.html'>best looking one</a> there is but how everything works so ingeniously and smoothly. Everything is pre-installed so I basically only had to customize a few things like creating a user (it took me a while to realize who the guy on the default avatar picture was since I was not moving too much), setting the time zone and the default keyboard layout, etc. And the fonts. Yes, the fonts above all. I remember how refreshing it was when I switched to a Gnome desktop from Windows XP several years ago. I felt the same but even stronger when I opened Firefox the first time on my new Mac. My heart is filled with joy using iTerm with the <a href='http://www.myfonts.com/fonts/apple/monaco/'>Monaco font</a>. I know font types and the look of fonts should probably be a detail for stone-hearted programmers but on the other hand beauty in details is so important. I spent some time thinking whether using nicer terminal fonts makes me a happier developer and it certainly does. I could do without the whizzing windows, sliding workspaces and flamboyant icons but I can not imagine using anything with less beautiful fonts. In three weeks I have become so fond of my precious little fonts I have a hard time imagining abandoning them.</p>

<p>But it is just me. What about you? What made you change to a Mac? What do you fancy most about it? Or if you are not a Mac owner, what do you like most about your Linux/Windows/etc. machine?</p>
    <a href="/2008/05/22/confession-of-a-conversion.html" title="Confession of a conversion">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/04/21/agile-help-with-rails.html">Agile help with Rails</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/04/21/agile-help-with-rails.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I have recently taken the habit of checking on <a href='http://railsforum.com'>Rails forum</a> from time to time whether there are unanswered questions I can help with. The best way to see a problem in its context is to recreate it and I was amazed by how easy it is to set up a rails site and debug e.g <a href='http://railsforum.com/viewtopic.php?id=17529'>a routing problem</a>.</p>
<div style='margin-top:20px;margin-bottom:20px'>
<code>
> rails railsforum_help_routing
> createdb railsforum_help_routing_development
(edit database.yml to set user and possibly database type)
> script/generate model Trip
> script/generate controller Trip
(edit routes.rb, in this case)
</code>
</div>
<p>Naturally the fact that all this takes about 5 minutes greatly leverages lending a hand to a fellow developer. Now that&#8217;s what I call agile!</p>
    <a href="/2008/04/21/agile-help-with-rails.html" title="Agile help with Rails">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/04/12/code-syntax-highlighting.html">Code syntax highlighting</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/04/12/code-syntax-highlighting.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I realized this would be a key feature of any blog that aims to include code snippets in posts right after my friend, Bronson, told me so. With Wordpress, it seems, the problem is not that there are no tools for a certain task but that there are too many. Anyway, I finally found <a href='http://wordpress.org/extend/plugins/wp-syntax/'>this one</a> to perfectly suit my needs. It supports a plethora of programming/markup languages and the only thing you should add to your code blocks, is a lang attribute to the &#60;pre&#62; like so:</p>
<pre lang='html4strict'>
   <pre lang='ruby'>
    (ruby code comes here)
   </pre>
</pre>
<p>My code in <a href='http://bucionrails.com/2008/04/09/quick-adaptor-my-role-model/'>my earlier post</a> looks a lot better, doesn&#8217;t it?</p>
    <a href="/2008/04/12/code-syntax-highlighting.html" title="Code syntax highlighting">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>

<div class="article">
  <h1>
    <a href="/2008/04/09/quick-adaptor-my-role-model.html">Quick adaptor - my role model</a>
    <span class="meta">
      
      <span class="date"></span>, <a href="http://ruby.meetup.hu/2008/04/09/quick-adaptor-my-role-model.html#disqus_thread" class="comments">kommentek</a>.
    </span>
  </h1>

  <div class="body">
    <p>I returned two weeks ago from the fantastic <a href='http://www.euruko2008.org/'>Euruko 2008 conference</a> in Prague dazzled by the outstanding presentations and the power of Ruby. It is hard to pick a favorite but I especially liked David Black&#8217;s &#8220;Per-Object Behavior in Ruby&#8221; (slides hopefully coming up) mainly because I am a sucker for metaprogramming and the true object-orientedness of Ruby in all its glory.</p>

<p>One fundamental concept was the singleton class which I think I&#8217;ve finally understood from this session. His example was the OpenStruct class whose instances learn to respond to all messages sent to them (this is Smalltalk/Ruby parlance, we could also say they learn to handle method calls) instead of throwing a NoMethodError. So I thought a great way to gain an insight of how this works is to actually code that up myself. Here is what I got: <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;ruby&quot;&gt;
require &apos;test/unit&apos;
class QuickAdaptor
  def method_missing(method_id, *args)
    method_name = method_id.to_s
    if method_name =~ /=$/
      attr = method_name.to_s.chop
      self.class.class_eval do
        define_method method_id do |x|
          instance_variable_set(&quot;@#{attr}&quot;, x)
        end
        method_name.chop!
        define_method method_name.to_sym do
          instance_variable_get &quot;@#{attr}&quot;
        end
      end
      instance_variable_set(&quot;@#{attr}&quot;, args[0])
    end
  end</pre></p>

<p>end</p>

<p>class QuickSingletonAdaptor # does the same as QuickAdaptor # but only defines methods for singleton # class of object, so it is not the class # that &#8220;learns&#8221;, but the singleton class def method_missing(method_id, <em>args) method_name = method_id.to_s if method_name =~ /=$/ attr = method_name.to_s.chop singleton_class = class &#171;&#160;self ; self; end singleton_class.instance_eval do define_method method_id do |x| instance_variable_set(&#8220;@#{attr}&#8221;, x) end method_name.chop! define_method method_name.to_sym do instance_variable_get &#8220;@#{attr}&#8221; end end instance_variable_set(&#8220;@#{attr}&#8221;, args<span>0</span>) end end</em></p>

<p>end</p>

<p>if <strong>FILE</strong> == $0 class ModuleTester &lt; Test::Unit::TestCase</p>

<pre><code>def test_quick_adaptor_creates_methods
  qa = QuickAdaptor.new
  qa.age = 18
  assert_equal(18, qa.age)
  qa.age = 24
  assert_equal(24, qa.age)
  assert_equal(nil, qa.name)
  qa.name = &#39;joe&#39;
  assert_equal(&#39;joe&#39;, qa.name)
  assert(!qa.respond_to(:nam))
end

def test_quick_adaptor_creates_instance_methods
  qa1 = QuickAdaptor.new
  qa1.age = 18
  qa2 = QuickAdaptor.new
  assert(qa2.respond_to?(:age=))
  assert(qa2.respond_to?(:age))
  assert_equal(nil, qa2.age)
end

def test_quick_singleton_adaptor_creates_singleton_methods
  qa1 = QuickSingletonAdaptor.new
  qa1.age = 18
  qa2 = QuickSingletonAdaptor.new
  # qa2 at this point should not know anything!
  assert(!qa2.respond_to?(:age=))
  assert(!qa2.respond_to?(:age))
end</code></pre>

<p>end end</p>
<pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;/pre&gt;</pre>
<p>As a test enthusiastic I embedded the tests in the same file which also has the advantage of giving a documentation of what the code achieves.</p>

<p>You can see that the real difference between the QuickAdaptor and QuickSingletonAdaptor classes lies in the following lines: <pre lang='ruby'>
class QuickAdaptor
  ...
  self.class.class_eval do
    define_method method_id do |x|
      ...
    end
  end
end
</pre> <pre class='markdown-html-error' style='border: solid 3px red; background-color: pink'>REXML could not parse this XML/HTML: 
&lt;pre lang=&quot;ruby&quot;&gt;
class QuickSingletonAdaptor
  ...
  singleton_class = class &lt;&lt; self ; self; end
  singleton_class.instance_eval do
    define_method method_id do |x|
      ...
    end
  end
end
&lt;/pre&gt;</pre> You can see from the tests that the QuickAdaptor shares the knowledge it gained with its peers (other QuickAdaptor instances), whereas QuickSingletonAdaptor is an egoist, it keeps it to itself! That&#8217;s why I agree with David Black that the best way to call the class that only one instance can access is singleton class because this has more expressive power than other terms (e.g metaclass, eigenclass, etc.)</p>

<p>My goal is to act like the QuickAdaptor, to suck in all ruby knowledge and learn as fast as QuickAdaptor does while having fun at the same time!</p>

<p>ps. I have also taken a look at how Matz&#8217;s <a href='http://www.ruby-doc.org/stdlib/libdoc/ostruct/rdoc/index.html'>OpenStruct class</a> accomplishes the same (well, much more :) ). It uses a table of fields where each new &#8220;member method&#8221; is defined. Nice.</p>
    <a href="/2008/04/09/quick-adaptor-my-role-model.html" title="Quick adaptor - my role model">tovÃ¡bb Â»</a>
  </div>
  <hr/>
</div>


        </div> <!-- left -->  
        <div id="right">
          <div id="wwr-recommend-me">
            <a title="Recommend me" href="http://workingwithrails.com/recommendation/new/person/12103-b-lint-rdi"><img alt="Recommend Me" src="/images/wwr-compact-small-button.jpg" border="0" /></a>
          </div>
          <div id="twitter-follow">
            <a href="http://twitter.com/baaz" title="Follow me on twitter">
              <img src="/images/twitter-magenta.png" border="0" />
            </a>
          </div>
        </div> <!-- right -->

      </div> <!-- main -->
    </div> <!-- content -->
  </body>
</html>